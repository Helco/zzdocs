{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>This is the home of the ZanZarah Knowledge Base, a project to gather as much (focus on technical) information as possible about the rather old PC-Game ZanZarah: The Hidden Portal made by Funatics Entertainment and originally released 2002 by THQ.</p> <p>The non-plus ultra goal of this project would be the recreation of the ZanZarah executable.</p>"},{"location":"#structure","title":"Structure","text":"<p>This wiki is first of all structured in four sections:</p> <ul> <li>Resources contain information about the fileformats and content</li> <li>Internal contain information about how the game behaves</li> <li>Gameplay contain information about what the player sees and interacts with</li> <li>Tools contain information about the tools created for this project</li> </ul>"},{"location":"#credits","title":"Credits","text":"<p>Before I started this project there were some people before me gathering useful information, some of which are stored here as well:</p> <ul> <li>The GTA Modding Wiki</li> <li>Dmitry \"kabbi\" Kabak</li> </ul>"},{"location":"Status/","title":"Status","text":""},{"location":"Status/#technical-stuff","title":"Technical stuff","text":""},{"location":"Status/#renderware-files","title":"Renderware files","text":"File extension Reading Writing Render Wiki Exports Imports DFF (Models) Yes No Yes Yes JSON None BSP (Worlds) Yes No Yes Yes JSON None SKA (Animations) Yes No Yes Yes JSON None"},{"location":"Status/#zanzarah-specific-files","title":"ZanZarah specific files","text":"File extension Reading Writing Render Wiki Exports Imports ED (Effects) Yes No No No JSON None FBS (Database) Yes No N/A Yes JSON, SQLite None AED (Actor description) Yes No Yes No JSON None SCN (Scene description) Yes No Yes Partly JSON None DAT (Savefiles) No No N/A Yes None None CFG (game.cfg) No No N/A No None None CFG (map.cfg) Yes No N/A Yes JSON None CFG (ai.cfg/net.cfg/wizform.cfg) Yes No N/A Yes JSON None"},{"location":"Status/#other-documentation-to-be-done","title":"Other documentation to be done","text":"Section Done Script commands - basic labeling 83/84 Script commands - full reference 0/84 Backdrop descriptions 0/19 Trigger type descriptions 25/56 Behavior type descriptions 1/56 Ambient sound descriptions 0/15"},{"location":"internal/AmbientSoundMgr/","title":"AmbientSounds","text":"<p>The AmbientSound Manager plays 3D soundeffects at random intervals near the player. The collection of sound files it uses is one of 17 hardcoded collections selected by the AmbientSound scene section. Also the interval it plays new sounds are hardcoded chances selected by the scene file.</p>"},{"location":"internal/AmbientSoundMgr/#behaviour","title":"Behaviour","text":"<p>For each entry in the sound collection the AmbientSoundMgr has one emitter, even though it might not be playing. On each update (which happens for the AmbientSoundMgr only every 100ms) if some emitter is not playing, there is a random number generated between 1 and 100 (inclusive). If this number is smaller than the chanced declared by the collection a new sound may start. If multiple emitters are free a random emitter is chosen. It is placed randomly in a cube around the player with a side length of 20 units, but only on integer coordinates.</p>"},{"location":"internal/AmbientSoundMgr/#collections","title":"Collections","text":"Value Sounds Description 0 1 2 4 5 6 7 8 9 10 11 12 14 15 16"},{"location":"internal/Animals/","title":"Animals","text":"<p>There exists a range of animals in the world of Zanzarah, none of which is essential to gameplay. The only animal type you can call essential would be the Pixie, but it is not seen internally as an animal, so this wiki won't either. Also animals internally usually have three components:</p> <ul> <li>The AnimalBase which is a reference used by the AnimalManager</li> <li>The AnimalController which holds and controls the actor, its animations, the location of the animal</li> <li>The AnimalBaseAI (mostly WaypointAI) which control its behaviour.</li> </ul> <p>Every animal has at least one actor description file associated to it and an activation distance. Outside of this distance animals are not updated. Additionally animals use their trigger arguments (most have a speed parameter).</p> Link Type Actor file Name Activation Distance  [x]  0 a000sa00a001sa00 Butterfly 120  [x]  1 a002sa01 Dragonfly 200  [x]  2 a003sa02a005sa04 Brown birdWhite? bird 400 3 unused type  [x]  4 a004sa03 Frog 300  [x]  5 a005sa04 Blue bird 5000  [x]  6 -/- Firefly 700  [x]  7 a006sa05a007sa06 Red buggreen bug 120  [x]  8 -/- Collection fairy 700  [x]  9 a008sa07 Rabbit 300  [x]  10 a020sa20a021sa20 Brown chickenWhite chicken 500  [x]  11 u010s10m \"Black pixie\" 300"},{"location":"internal/Animals/#butterfly","title":"Butterfly","text":"<p>The butterfly chooses randomly with equal chances between his two actor files. The speed is stored in the ii2 argument (<code>speed = ii2 * 0.001</code>). It rotates in an 8 shape and normally does not check for collisions with the world. In almost all cases it  first rotates clock-wise?, but with a very small chance (about 1 to 2^31) it rotates the other way around. This is most likely a bug by the programmer, as the original formula looks like this: <code>randomFloat() &lt;= 0.0</code></p>"},{"location":"internal/Animals/#butterflyai","title":"ButterflyAI","text":"<p>In Pseudo-code the AI update looks like this:</p> <pre><code>degreeDelta = timeDelta * 40\nnewDegrees = lastDegrees + degreeDelta\nlastDegrees = newDegrees\nif (newDegrees &gt; 360) {\n    degreeDelta -= (360 - degreeDelta)\n    rotateDir *= -1\n    lastDegrees = 0\n}\nrotateY(degreeDelta * rotateDir)\nmoveForward(speed * timeDelta)\n</code></pre>"},{"location":"internal/Animals/#dragonfly","title":"Dragonfly","text":"<p>The dragonfly uses the WaypointAI with a max idle time of 4 and a speed of 5. It does not flee nor crawl.</p>"},{"location":"internal/Animals/#bird","title":"Bird","text":"<p>If there is a single bird trigger in the scene, four bird slots are created for the whole scene. More triggers do not mean more birds. Birds are spawned when their slot is free and they follow a simple movement pattern. Between the two actor files are chosen randomly with equal distribution, their speed is fixed at 4.</p>"},{"location":"internal/Animals/#birdai-implemented-directly-in-their-update-function-not-as-ai-class","title":"BirdAI (implemented directly in their update function, not as AI class)","text":"<p>If they haven't spawned yet or are marked as spawnable, they may spawn each frame with a chance of 60% and run this code:</p> <pre><code>setLocationToTrigger()\nv1 = Vector(\n    triggerDir.X * -1,\n    0,\n    triggerDir.Y * -1)\nmove( normalize(v1) * 10 )\n\npitchSpeed = ii3 * 0.001\ndistanceLeft = (randomFloat()+0.5) * 50\n</code></pre> <p>if they are spawned their update code looks like this:</p> <pre><code>moveDistance = speed * timeDelta; // remember: speed is fixed at 4\nnewDistanceLeft = distanceLeft - moveDistance\nif (newDistanceLeft &gt; 0) {\n    triggerDir.y += timeDelta * pitchSpeed\n    setDirection(triggerDir)\n    move( triggerDir * moveDistance )\n}\nelse\n    markAsSpawnable();\n</code></pre>"},{"location":"internal/Animals/#frog","title":"Frog","text":"<p>The frog has just one actor file, it uses the WaypointAI and moves with a speed of 5. It does not flee, but crawl in full cycles and idles at max 5 seconds.</p>"},{"location":"internal/Animals/#bluebird","title":"BlueBird","text":"<p>The blue bird has just one actor file and uses a custom AI. It circles around a center point defined by moving <code>ii2 * 0.01</code> units from the trigger in trigger direction. Its speed is <code>ii3 * 0.001</code>.</p>"},{"location":"internal/Animals/#bluebirdai","title":"BlueBirdAI","text":"<pre><code>moveSin = sin(timeDelta * speed)\nmoveCos = sin(timeDelta * speed)\ndeltaPos = pos - center\nnewPos = center + Vector(\n    moveCos * deltaPos.X - moveSin * deltaPos.Z,\n    pos.Y,\n    moveSin * deltaPos.X + moveCos * deltaPos.Z)\n\nsetDirection( normalize( newPos - pos) )\nsetPosition( newPos )\n</code></pre>"},{"location":"internal/Animals/#firefly","title":"Firefly","text":"<p>The firefly does not have an actor file, instead it uses the effect 4018. It is controlled by the WaypointAI. Its speed is set at spawn as <code>randomFloat() * 3.0</code>,  as well as his max idle time <code>randomFloat()</code>. Also at start his max bounce height is set to <code>ii2 * 0.5</code> and a start bounce is set as random integer value between 0 and <code>maxBounce</code>.</p> <p>It uses an additional update functionality:</p> <pre><code>curBounce += timeDelta * 1000\nif (curBounce &gt; maxBounce) {\n    curBounce = 0;\n    maxBounce = randomFloat() * 600 + 400; // yes this overwrites the parameter ii2\n}\nmoveUp( sin( curBounce * 2 * PI / maxBounce ) * 0.02)\n</code></pre>"},{"location":"internal/Animals/#bug","title":"Bug","text":"<p>The bug chooses randomly with equal distribution between his two actor files. It crawls at a fixed speed of 0.2 according to the WaypointAI. It does not flee.</p>"},{"location":"internal/Animals/#collectionfairy","title":"CollectionFairy","text":"<p>The collection fairy is the only animal type, that can not be put in a scene, as in \"it will not spawn if put into a scene file\". It is spawned automatically based on the unused fairies of the player and the CollectionWizform triggers, which only occur in London. It uses its own AI and is not influenced by any trigger arguments. The fairy type and thus its actor file is set upon spawn, the frequency at which the fairy bounces is also set at spawn to <code>randomFloat() * 40 + 60</code>.</p>"},{"location":"internal/Animals/#collectionfairyai","title":"CollectionFairyAI","text":"<pre><code>posOffset = Vector(\n    0.1 * cos(allTime * 0.0033333),\n    0.02 * cos(allTime / bounceFreq),\n    0.1 * sin(allTime * 0.0033333))\ndirToPlayer = normalize( playerPos - triggerPos )\n\nsetPosition( triggerPos - dirToPlayer + posOffset );\nlookAt(playerPos)\n</code></pre>"},{"location":"internal/Animals/#rabbit","title":"Rabbit","text":"<p>Rabbits only have one actor file, they crawl at a speed of 2.1 in full cycles lead by the WaypointAI, whilst idling at max 5 seconds. They do not flee from the player.</p>"},{"location":"internal/Animals/#chicken","title":"Chicken","text":"<p>Chicken have two actor files, chosen by their trigger argument <code>ii2</code>. They use the WaypointAI and are the only one using this AI, which do flee from the player. They crawl at a speed of 2.1 and idle at max 6 seconds. Furthermore they are placed at a random animal waypoint around their actual waypoint, but not at those whose distance is greater than 500.</p>"},{"location":"internal/Animals/#black-pixie","title":"Black pixie","text":"<p>Before starting: the name \"Black Pixie\" may not be the internal name. Internal names are not found yet and this name may be highly inaccurate. Maybe some day one of the original developers will tell us more about it. The black pixie only has a single actor file, it uses the WaypointAI and crawls at a speed of 2.1 in full cycles. It idles at max 5 seconds.</p>"},{"location":"internal/Animals/#waypointai","title":"WaypointAI","text":"<p>Last but not least, the WaypointAI shall be described. It is the most used animal AI in the game, but also has some specialized behaviour for different animals.</p> <p>TODO</p>"},{"location":"internal/Behaviors/","title":"Model behaviors","text":"<p>This page lists certain special model behavior types and describes them in a bit more detail.</p>"},{"location":"internal/Behaviors/#locked-doors","title":"Locked doors","text":"<p>This affects the following behaviors: DoorGold, DoorSilver, CityDoorLock, DoorCopper, DoorBronze, DoorIron, DoorGlass, DoorRed, DoorYellow, DoorBlue.</p> <p>These are all doors, which are unlocked by standing near (&lt; 3.0) the door whilst having the right item in the inventory. The mapping which item unlocks what is hardcoded:</p> Door behavior CardId Item name (maybe not be accurate) DoorGold 21 Catacomb key DoorSilver 22 Heavy iron key CityDoorLock 22 Heavy iron key DoorCopper 23 Key of the pixie guard DoorBronze 24 Rufus' key DoorIron 25 Dwarf factory key DoorGlass 27 Towns hall key DoorRed 71 Red bone key DoorYellow 72 Green bone key DoorBlue 73 Blue bone key"},{"location":"internal/Behaviors/#collectable","title":"Collectable","text":"<p>The collectable behavior is essentially an item, because the item id the player gets is determined by the model filename (itm###.dff), not all items can be collected by an item bag/catching sphere.  Additionally there are three special item models (itmxxx.dff / itmyyy.dff / itmzzz.dff) which have hardcoded random items they can give up on picking up:</p>"},{"location":"internal/Behaviors/#itmxxx","title":"itmxxx","text":"Chance Item 40% 3-9 Gold 30% Small healing potion 15% Normal healing potion 10% Big healing potion 5% Healing herb"},{"location":"internal/Behaviors/#itmyyy","title":"itmyyy","text":"Chance Item 40% Small healing potion 20% Garlic 10% Normal healing potion 10% Big healing potion 10% Healing herb 10% Mana potion"},{"location":"internal/Behaviors/#itmzzz","title":"itmzzz","text":"Chance Item 33% Big healing potion 16% Healing herb 16% Mana potion 16% Garlic 16% Golden carrot <sub>Of course the values are 33,3...% and 16,6...%</sub>"},{"location":"internal/CardId/","title":"CardId","text":"<p>The CardId is used by ZanZarah to have a (or another) unique identifier to address items, fairies and spells.</p>"},{"location":"internal/CardId/#format","title":"Format","text":"<p>The CardId can be split up in three distinct numbers which hold information:</p> Bits Description 0-7 Unknown field, propably a validation (set to 0xff) 8-15 Type of the CardID (0 = Item, 1 = Spell, 2 = Fairy) 16-31 ID of entity"},{"location":"internal/Classes/","title":"Element classes","text":"Value Internal name 0 none 1 Nature 2 Air 3 Water 4 Light 5 Energy 6 Mental 7 Stone 8 Ice 9 Fire 10 Dark 11 Chaos 12 Metal 13 Neutral <p>One should point out that values 0 and 13 are used in spell requirements where they signal whether every or no spell may require the particular slot.</p>"},{"location":"internal/GlobalVars/","title":"Global variables","text":"<p>There are two script commands referring global variables (<code>setGlobal</code> and <code>beginIf_global</code>), but these commands don't occur in any scripts in the database. It seems like this system was once used but later deprecated and remained unused until release.</p>"},{"location":"internal/GlobalVars/#internal-workings","title":"Internal workings","text":"<p>The two script commands are implemented in the executable and do set one of 49 variables saved in a special class. They are also saved as end section of every savefile, but the values of the variables stay zero. Every variable has an internal change counter which is initialized to a random value (for reasons unknown) between 0 and 2^16.</p> <p>It stands to reason that this system was deprecated as numeric variable identifiers are not very user-friendly.</p>"},{"location":"internal/RenderOrder/","title":"RenderOrder","text":""},{"location":"internal/RenderOrder/#3d","title":"3D","text":"<p>Defaults: Wrap | True | LessEqual | True | True | 0 | SrcAlpha | InvSrcAlpha | 0.082352944 | True |</p> Render State Description TexAddress Fog ZFunc ZTest ZWrite ZBias SrcBlend DestBlend AlphaRef? VertexAlpha 67 Static backdrop Wrap True LessEqual True True 0 SrcAlpha InvSrcAlpha 0.082352944 True Dynamic backdrop 56 World Wrap True LessEqual True True 0 One Zero 0.082352944 True 44 Footprints Wrap True LessEqual True False 1 SrcAlpha InvSrcAlpha 0.082352944 True 63 Actor parts Wrap True LessEqual True True 0 SrcAlpha InvSrcAlpha 0.082352944 True 58 FOModel Standard Wrap True LessEqual True True 0 SrcAlpha InvSrcAlpha 0.082352944 True 59 FOModel Additive 3 Wrap False LessEqual True True 0 SrcAlpha One 0.082352944 True Effect Order 0 64 Model Wrap True LessEqual True True 0 SrcAlpha InvSrcAlpha 0 True 58 FOModel Standard 2 Wrap True LessEqual True True 0 SrcAlpha InvSrcAlpha 0.082352944 True 59 FOModel Additive 2 Wrap False LessEqual True True 0 SrcAlpha One 0.082352944 True 61 FOModel EnvMap Wrap True LessEqual True False 1 SrcAlpha InvSrcAlpha 0.082352944 True Effect Order 1 68 DynModels Not4 Wrap True LessEqual True True 0 SrcAlpha InvSrcAlpha 0 True 69 DynModels Wrap True LessEqual True True 0 One Zero 0.082352944 True 58 FOModel Standard 3 Wrap True LessEqual True True 0 SrcAlpha InvSrcAlpha 0.082352944 True 60 FOModel Additive 1 Wrap False LessEqual True False 0 SrcAlpha One 0.082352944 True 65 Effect Order 2 WrapNoPersp True LessEqual True False 0 SrcAlpha InvSrcAlpha 0 True StdEffect 66 Debug Waypoint system Wrap True LessEqual True True 0 SrcAlpha InvSrcAlpha 0.082352944 True Debug Actor collider Debug FOModel collider Debug Triggers Debug Waypoint trigger Debug Soundeffects 3D Mod DebugIcon Effects DebugIcon Soundeffects 3D DebugIcon Triggers DebugIcon Lights DebugIcon FOModels DebugText Effects DebugText Models DebugText FOModels DebugText DynModels Debug local trigger points Debug spline"},{"location":"internal/RenderStates/","title":"RenderStates","text":"<p>Internally the engine manages the render properties by a collection of 70 render states which are applied right before an object is rendered. However properties in these states can be unset, in which case the current value is unmodified. At various stages during the rendering a default state is applied which has a full set of properties overwriting every state before.</p> <p>Many states are equal, pointing towards a semantic name that was lost during compilation.</p> Name TexAddressU TexAddressV TexPerspective TexFilter ZTest ZWrite ShadeMode SrcBlend DstBlend FogType Fog VertexAlpha FogColor FogDensity ZFunc AlphaFunc AlphaRef ZBias AlphaTest def no name yet Wrap Wrap True MipLinear True True Gouraud SrcAlpha InvSrcAlpha Linear True True 254,230,184,0 0.1 LessEqual GreaterEqual 0.0823529 0 True 0 no name yet Clamp Clamp - - True True - One One - - True - - - - - - - 1 no name yet - - - - - False - SrcAlpha DestAlpha - - - - - - - - - - 2 no name yet - - - - - False - SrcAlpha InvSrcAlpha - - - - - - - - - - 3 no name yet - - False - - - Gouraud - - - - True - - - - - - - 4 no name yet Clamp Clamp - - True False - SrcAlpha InvSrcAlpha - - True - - - Always - - - 5 no name yet Clamp Clamp - - True False - SrcAlpha One - - True - - - Always - - - 6 no name yet - - - - False False - SrcAlpha One - False - - - - - 0.0196078 - - 7 no name yet Clamp Clamp - - False False - SrcAlpha One - False - - - - - 0.0196078 - - 8 no name yet Wrap Wrap - - True True - One SrcAlpha - - True - - - - - - - 9 no name yet Wrap Wrap - - True False - SrcAlpha One - - True - - - - - - - 10 no name yet - - - - True False - SrcAlpha One - - - - - - - - - - 11 no name yet Clamp Clamp - - True True - One SrcAlpha - - True - - - - - - - 12 no name yet - - - - - - - - - - False - - - - - - - - 13 no name yet Wrap Wrap - - True False - SrcAlpha One - - True - - - - - - - 14 no name yet Clamp Clamp - - True False - SrcAlpha One - - - - - - - - - - 15 no name yet Clamp Clamp - - True False - SrcAlpha One - - - - - - - 0 - - 16 no name yet - - - - True True - SrcAlpha One - - - - - - - 0 - - 17 no name yet Wrap Wrap - - True False - SrcAlpha One - - - - - - - - - - 18 no name yet Wrap Wrap - - True False - One Zero - - - - - - - - - - 19 no name yet - - - - - - - - - - - - - - - - - - - 20 no name yet - - - - - - - - - - - - - - - - - - - 21 no name yet Clamp Clamp - - True False - SrcAlpha One - - - - - - - 0 - - 22 no name yet Clamp Clamp - - True False - SrcAlpha One - False - - - - - 0 - - 23 no name yet Wrap Wrap - - False False - SrcAlpha One - - - - - - - 0.03 - - 24 no name yet - - - - - - - - - - - - - - - - - - - 25 no name yet - - - - False False - One One - - True - - - - - - - 26 no name yet - - - - True False - SrcAlpha InvSrcAlpha - - False - - - GreaterEqual 0 - True 27 no name yet - - - - - False - SrcAlpha InvSrcAlpha - - - - - - - 0 - - 28 no name yet - - - - True False - SrcAlpha InvSrcAlpha - - False - - - GreaterEqual 0 - True 29 no name yet - - - - True False - SrcAlpha InvSrcAlpha - False False - - - GreaterEqual 0 - True 30 no name yet - - - - False False - - - - - - - - - - - - - 31 no name yet - - - - False False - - - - - - - - - - - - - 32 no name yet - - - - - - - - - - False - - - - - - - - 33 no name yet - - - - - - - - - - - - - - - - - - - 34 no name yet - - - - False False - - - - False - - - - - - - - 35 no name yet - - - - - - - - - - - - - - - - - - - 36 no name yet - - - - - - - - - - - - - - - - - - - 37 no name yet - - - - - - - - - - - - - - - - - - - 38 no name yet - - - - False False - - - - - - - - - - - - - 39 no name yet - - - - - False - One Zero - - False - - - - - - False 40 no name yet - - - - - False - SrcAlpha InvSrcAlpha - - True - - - Always - - True 41 no name yet - - - - - False - SrcAlpha One - - True - - - Always - - True 42 no name yet - - - - False False - SrcAlpha InvSrcAlpha - False True - - - - - - - 43 no name yet - - - - False False - One Zero - False - - - - - - - False 44 no name yet - - - - - False - - - - - - - - - - - 1 - 45 no name yet - - - - False False - - - - False - - - - - 0.03125 - - 46 no name yet - - - - - - - - - - - - - - - - - - - 47 no name yet - - - - False False - One One - False - - - - - 0 - - 48 no name yet - - - - False False - SrcAlpha One - False - - - - - 0 - - 49 no name yet - - - - False True - SrcAlpha InvSrcAlpha - False - - - - - 0.03125 - - 50 no name yet - - - - False False - One Zero - False - - - - - 0 - - 51 no name yet - - - - False False - Zero InvSrcAlpha - False - - - - - 0 - - 52 no name yet Clamp Clamp - - - - - - - - False - - - - - - - - 53 no name yet Clamp Clamp - - - False - Zero InvSrcColor - False True - - - - - 1 - 54 no name yet Clamp Clamp - - - False - SrcAlpha - - - True - - - - - - - 55 no name yet - - - - - - - - - - False True - - Greater - - - - 56 no name yet - - - - - - - One Zero - - - - - - - - - - 57 no name yet - - - - - - - - - - - - - - - - - - - 58 no name yet - - - - - - - SrcAlpha InvSrcAlpha - - - - - - - - - - 59 no name yet - - - - - True - SrcAlpha One - False - - - - - - - - 60 no name yet - - - - - False - SrcAlpha One - False - - - - - - - - 61 no name yet - - - - True False - SrcAlpha InvSrcAlpha - - - - - - - - 1 - 62 no name yet - - - - - - - - - - - - - - - - - - - 63 no name yet - - - - - - - - - - - - - - - - - - - 64 no name yet - - - - - - - SrcAlpha InvSrcAlpha - - - - - - GreaterEqual 0 - True 65 no name yet - - False - - False - SrcAlpha InvSrcAlpha - - - - - - - 0 - - 66 no name yet - - - - - - - - - - - - - - - - - - - 67 no name yet - - - - - - - - - - - - - - - - - - - 68 no name yet - - - - - True - SrcAlpha InvSrcAlpha - - - - - - - 0 - - 69 no name yet - - - - True True - One Zero - - - - - - - - - -"},{"location":"internal/Scripts/","title":"Script language","text":""},{"location":"internal/Scripts/#general-information","title":"General information","text":"<p>Every script is stored in the database. There are 6 different locations a script may be stored:</p> Module Column Impl. Description fb0x01 Script1 3 This script is executed when the NPC is activated, it often contains dialog control fb0x01 Script2 1 This script seems to be executed when the NPC is deployed, it mostly contains <code>setModel</code> instructions fb0x01 Script3 1 This script seems to be executed on a cyclic basis, but the details are not known yet fb0x01 Script4 3 This script is executed if the player wins a fight against the NPC fb0x01 Script5 3 This script is executed if the player loses a fight against the NPC, mostly contains <code>killPlayer</code> instructions fb0x04 Script 2 This script is executed when the item is used on some fairy. It does everything from healing to evolving"},{"location":"internal/Scripts/#general-format","title":"General format","text":"<p>ZanZarah scripts are written one command per line. The first character always denotes the command, after this there may be up to 3 arguments (decimal numbers or UIDs) seperated by a period. For every command character there exists a long form command that is more human-readable. These forms are extracted from the executable.</p>"},{"location":"internal/Scripts/#control-flow","title":"Control flow","text":"<p>TODO</p> <p>Some commands pause the current execution, so that it can be continued at a later point.</p>"},{"location":"internal/Scripts/#implementations","title":"Implementations","text":"<p>It seems like there are four different implementations and the base implementation which triggers errors for every command except the pure structural ones: The implementations may use the following commands:</p> <ol> <li><code>setModel, setCamera, wizform, spell, changeWaypoint, lookAtPlayer, removeNpc, ifTriggerIsActive, moveSystem, movementSpeed,    lockUserInput, playAnimation, startPrelude, setNpcType, deployNpcAtTrigger, ifCloseToWaypoint, ifNpcModifierHasValue,    setNpcModifier, defaultWizform, idle, ifPlayerIsClose, setCollision, createDynamicItems, revive, lookAtTrigger</code></li> <li><code>modifyWizform, ifIsWizform</code></li> <li><code>ask, say, choice, waitForUser, setCamera, changeWaypoint, fight, changeDatabase, removeNpc, catchWizform, killPlayer, tradingCurrency,    tradingItem, tradingSpell, tradingWizform, givePlayerCards, setupGambling, ifPlayerHasCards, ifPlayerHasSpecials,    ifTriggerIsActive, removePlayerCards, lockUserInput, modifyTrigger, playAnimation, npcWizFormEscapes, talk, chafferWizForms,    deployNpcAtTrigger, delay, removeWizForms, ifNpcModifierHasValue, setNpcModifier, ifPlayerIsClose, ifNumberOfNpcsIs,    startEffect, setTalkLabels, tradeWizform, createDynamicItems, playVideo, removeNpcAtTrigger, revive, ifTriggerIsEnabled,    playSound, playInArena, endActorEffect, createSceneObjects, removeBehavior, unlockDoor, endGame, subGame, modifyEffect,    playPlayerAnimation, playAmyVoice, createDynamicModel, deploySound, givePlayerPresent</code></li> <li><code>dance</code></li> </ol> <p>The purely structural commands that are always available are: <code>else, setGlobal, beginIf_global, goto, gotoRandomLabel, gotoLabelByRandom, endIf, label, exit</code></p>"},{"location":"internal/Scripts/#default-scripts","title":"Default scripts","text":"<p>There are several default scripts hidden in the executable, three of which refer to wild fairies attacking the player, the fourth one sets up some fight with 5 fairies. This last one is most likely a debug fight.</p>"},{"location":"internal/Scripts/#wild-fairy-attacks-player-executed-as-npc-script-1","title":"Wild fairy attacks player (executed as NPC script 1)","text":"<pre><code>fightInArena0.0\nexit\n</code></pre>"},{"location":"internal/Scripts/#player-wins-a-fight-against-a-wild-fairy-executed-as-npc-script-4","title":"Player wins a fight against a wild fairy (executed as NPC script 4)","text":"<p>if killed</p> <pre><code>???.10 //opcode yet to be known\nnpcWizFormEscapes\n</code></pre> <p>else if catched</p> <pre><code>say.2627D615.1 (do you want to catch this fairy)\nchoice.0.B2153621 (yes)\nchoice.1.2F5B3621 (no)\nwaitForUser\nlabel.0\nremovePlayerCards.1.0.arg //arg is the item id of the sphere used\ncatchWizform\nwaitForUser\nexit\nlabel.1\nnpcWizFormEscapes\nwaitForUser\nexit\n</code></pre>"},{"location":"internal/Scripts/#player-loses-a-fight-against-a-wild-fairy-executed-as-npc-script-5","title":"Player loses a fight against a wild fairy (executed as NPC script 5)","text":"<pre><code>killPlayer\nexit\n</code></pre>"},{"location":"internal/Scripts/#debug-script-to-test-fights-executed-as-npc-script-2","title":"Debug script to test fights? (executed as NPC script 2)","text":"<pre><code>enterWizform.0.1.1 //Viteria\nenterSpell.0.0.0\nenterSpell.0.1.60\nenterSpell.0.2.10\nenterSpell.0.3.70\nsetNPCType.3\nenterWizform.1.15.1 //Rasrow\nenterSpell.1.0.0\nenterSpell.1.1.61\nenterSpell.1.2.11\nenterSpell.1.3.70\nsetNPCType.3\nenterWizform.2.10.1 //Corgot\nenterSpell.2.0.0\nenterSpell.2.1.62\nenterSpell.2.2.12\nenterSpell.2.3.72\nsetNPCType.3\nenterWizform.3.57.1 //Tinefol\nenterSpell.3.0.0\nenterSpell.3.1.63\nenterSpell.3.2.13\nenterSpell.3.3.73\nsetNPCType.3\nenterWizform.4.4.1 //Gremor\nenterSpell.4.0.0\nenterSpell.4.1.64\nenterSpell.4.2.14\nenterSpell.4.3.74\nsetNPCType.3\nexit\n</code></pre>"},{"location":"internal/Scripts/#commands","title":"Commands","text":"Char Max args Stops Name Description ! 2 No say triggers a dialog line C 1 No setModel single arg is name of AED file \" 2 No choice # 0 Yes waitForUser $ 1 No label single arg is numeric label identifier, used with goto command &amp; 1 No setCamera moves the camera % 0 Yes exit stops script execution ' 3 No wizform adds a fairy ( 3 No spell adds a spell 8 0 No else see control flow, sometimes refered as \"item\" ) 2 Yes changeWaypoint * 2 Yes fight starts a duel + 2 Yes lookAtPlayer NPC looks at the player , 1 No changeDatabase NPC changes its database row (single fb0x05 UID argument) permanently - 0 No removeNpc removes a NPC . 0 Yes catchWizform 0 0 Yes killPlayer kills the player (captain obvious) 5 1 No tradingCurrency sets the currency item by single fb0x04 UID argument 2 2 No tradingItem adds a buyable item with a price (first arg) and a fb0x04 UID argument 3 2 No tradingSpell adds a buyable spell with a price (first arg) and a fb0x03 UID argument 4 2 No tradingWizform adds a buyable fairy with a price (first arg) and a fb0x01 UID argument 1 3 No givePlayerCards adds cards (item/spell/fairy) to the player B 3 No setupGambling adds chances for cards/blanks 6 3 No ifPlayerHasCards branches based on cards in inventory @ 2 No ifPlayerHasSpecials branches based on special conditions = 1 No ifTriggerIsActive 9 3 No removePlayerCards removes cards from the players inventory : 2 Yes moveSystem ? 1 No movementSpeed Sets the movement speed to a tenth of the single numerical parameter ; 2 No modifyWizform Changes the triggered fairy &lt; 1 No lockUserInput &gt; 3 No modifyTrigger A 2 Yes playAnimation D 1 No ifIsWizform E 0 Yes startPrelude F 0 Yes npcWizFormEscapes G 1 No dance H 2 No setGlobal I 2 No beginIf_global J 2 No talk K 1 No goto L 2 No gotoRandomLabel M 3 No ask N 3 No chafferWizForms O 1 No setNpcType P 2 No deployNpcAtTrigger Q 1 Yes delay R 2 No gotoLabelByRandom S 1 No ifCloseToWaypoint T 0 No removeWizForms U 1 No ifNpcModifierHasValue V 3 No setNpcModifier W 3 No defaultWizForm X 0 Yes idle Y 1 No ifPlayerIsClose Z 2 No ifNumberOfNpcsIs [ 2 No startEffect \\ 3 No setTalkLabels ] 1 No setCollision ^ 1 No tradeWizform _ 3 No createDynamicItems ` 1 Yes playVideo a 1 No removeNpcAtTrigger b 0 No revive c 2 No lookAtTrigger d 1 No ifTriggerIsEnabled e 1 No playSound f 2 Yes playInArena g 1 No startActorEffect h 0 No endActorEffect i 1 Yes createSceneObjects j 1 No evolveWizForm k 1 No removeBehavior l 2 No unlockDoor m 0 No endGame n 3 No defaultDeck o 3 No subGame p 3 No modifyEffect q 2 No playPlayerAnimation s 1 No playAmyVoice r 3 No createDynamicModel t 2 No deploySound u 1 No givePlayerPresent 7 0 No endIf"},{"location":"internal/Spell%20Damage/","title":"Spell Damage","text":"<p>To be extended/simplified</p>"},{"location":"internal/Spell%20Damage/#formula","title":"Formula","text":"<p>First some variables to consider:</p> <ul> <li><code>BaseDmg</code>  As per the damage stat of the spell this is <code>50, 65, 70, 95, 110</code></li> <li><code>ClassF</code>  Class effectiveness with <code>1</code> being neutral, <code>3</code> very effective, <code>1/3</code> not effective</li> <li><code>SupportAttackF</code>  A more damage support behavior on the attacking fairy</li> <li><code>SupportDefenseF</code>  A less damage taken support behavior on the defensing fairy</li> <li><code>CritF</code>  A more damage on critical support behavior on the attacking fairy</li> <li><code>ChargeF</code>  The amount of charge-up before firing (from 0 to 1)</li> <li><code>Level</code>  The level of the attacking fairy</li> </ul> <p>Then we can calculate intermediaries:</p> <ul> <li><code>LevelF = Level / 60</code></li> <li><code>SpellF = CritF * SupportAttackF * SupportDefenseF * ClassF * ChargeF * -1</code></li> <li><code>FinalF = SpellF * LevelF * 0.95 + SpellF * 0.05</code></li> </ul> <p>And finally the damage of the spell: <code>Damage = FinalF * BaseDmg</code></p>"},{"location":"internal/Spell%20Damage/#anti-pirate-mechanism","title":"Anti-Pirate mechanism","text":"<p>If the anti-pirate mechanism triggered that damage is multiplied by <code>10</code> if the attacking fairy is an NPC and divided by <code>10</code> if the attacking fairy is the player.</p>"},{"location":"internal/Triggers/","title":"Trigger behaviors","text":"<p>This page lists trigger types and describes them in a bit more detail.</p>"},{"location":"internal/Triggers/#doorway","title":"Doorway","text":"<p>Doorway triggers have three parameters:</p> <ol> <li>The own doorway id</li> <li>The doorway id in the target scene</li> <li>The target scene id</li> </ol>"},{"location":"internal/Triggers/#singleplayerstartpoint","title":"SingleplayerStartpoint","text":"<p>The name of the SingleplayerStartpoint triggers are propably deprecated, as Doorway took their place. Nevertheless these triggers appear in each overworld scene and in many duel scenes. In duel scenes their meaning is yet to be known (propably identical to MultiplayerStartpoint), in overworld scenes however describes this trigger where to place the Amy if she was teleported by the console.</p>"},{"location":"internal/Triggers/#npcattackposition","title":"NpcAttackPosition","text":"<p>This trigger is mostly used for wild fairies to attack the player, but it is also used for a friendly fairy warning about wild ones and an elf wanting a fight. These are the parameters:</p> <ol> <li>The NPC UID to use, often just the dummy UID for wild fairies. The actual scripts are generated on runtime.</li> <li>unknown parameter (either 0, 1, 2, 3 or 50), seems to describe the condition on which the trigger is enabled<ul> <li>0 or 2 uses the percentage in ii3</li> </ul> </li> <li>The chance percentage whether the fairy does actually attack</li> <li>An index to an internal list of fairies which may attack you at this specific position (see below).</li> </ol> Idx Fairies 0 Worgot, Blumella 1 Corgot, Lana 2 Tinefol, Viteria, Silia 3 Pfoe, Tinefol 4 Abery, Corgot 5 Worgot, Abnobery 6 Abery, Silia 7 Cera 8 Goop, Cera 9 Goop, Tadana 10 2x Tadana, Amnis, Ceramnis 11 Vesbat 12 Jumjum, Vesbat 13 Gremor, Stobat 14 Grem, Jumjum 15 Mencre, Mensec 16 Mencre, Mentaur 17 Mencre, Mentaur 18 2x Beltaur, Mencre 19 Airia, Luria 20 Gorael, Sirael 21 Sirella, Sirael 22 Dracwin 23 2x Pix, Ferix 24 Feez, Greez 25 Greezloc, Glacess 26 Rasrow, Skelbo 27 Rasrow, Skelbo 28 Rasrow, Akritar, Manox 29 Manox, Turnox, Violectra 30 Minari 31 Minari 32 Minari, Megari, Violectra 33 2x Lighane, Driane, Darbue"},{"location":"internal/Triggers/#cameraposition","title":"CameraPosition","text":"<p>CameraPosition triggers are used to set the camera view via scripts. For this the <code>setCamera</code> command is used. The only parameter of this trigger is the Id of this CameraPosition.</p>"},{"location":"internal/Triggers/#waypoints","title":"Waypoints","text":"<p>There are two types of waypoints: regular waypoints and animal waypoints. As the name might tell, regular waypoints are used by NPCs while animal waypoints are used by animals.</p> <p>Waypoints are connected by a set of rules: * The trigger type is the same (no Waypoint is connected to an AnimalWaypoint) * Their group parameter (ii2) is the same * Their distance from each other is at max 7 units</p> <p>The first parameter seems to be some kind of Id, most likely to be used in Scripts. The third parameter (ii3) is not null if it is selected as a target for a NPC.</p>"},{"location":"internal/Triggers/#animal","title":"Animal","text":"<p>Animals are non-interactive creatures wandering around the world of ZanZarah. ii1 holds the animal type, while ii2 and ii3 are animal-specific parameters. See Animals for detailed information.</p>"},{"location":"internal/Triggers/#platform","title":"Platform","text":"<p>Platform is used by CreatePlatforms trigger to state where the platforms should appear and how they should move. As model there is always <code>g_plt00h</code> used, ii1 states the Behavior which is connected to the model.</p> Value Behavior Description 0 MagicBridgeStatic as the name states, platforms with this Behavior do not move 1 MagicBridge0 unused 2 MagicBridge1 3 MagicBridge2"},{"location":"internal/Triggers/#createplatforms-createitems","title":"CreatePlatforms CreateItems","text":"<p>These trigger create on player collision either platforms or items, their respective triggers (Platform and Item) describe the position. The effect used at trigger position is unknown yet, but for each platform/item the effect 4022 is used. If the game finds an EventCamera trigger, the view switches to it. The platforms/items appear after 1 second the player activated the trigger in a 0.3 second interval (so the first platform/item takes 1.3 seconds). The order they appear in is reverse to the order they are saved in the scene.</p>"},{"location":"internal/Triggers/#item","title":"Item","text":"<p>Item is used by CreateItems trigger to state where and which items should appear. ii1 is the id of the item. For coins and crystals, the Behavior GenBehavior_EFF0 is used, for all other items GenBehavior.</p>"},{"location":"internal/ZZVersion/","title":"ZZVersion","text":""},{"location":"internal/ZZVersion/#zzversion","title":"ZZVersion","text":"<p>There exists a common structure for versions in Zanzarah, used internally in the executable, in scenes and savefiles.</p>"},{"location":"internal/ZZVersion/#format","title":"Format","text":"Size Type Description zstring The name of the author 4B enum The country in which the game version was released (see countries) 4B enum The type of release (see build types) 4B uint unknown 4B uint The build versions, it seems like build versions shall be incompatbible to each other 4B zstring A formatted date string at which the file was built 4B zstring A formatted time string at which the file was built 4B uint The year at which the file was built 4B uint unknown"},{"location":"internal/ZZVersion/#build-countries","title":"Build Countries","text":"Value Description 0 Germany 1 English 2 France 3 Spain 4 Italy 5 Japanese 6 English6 8 Russia"},{"location":"internal/ZZVersion/#build-types","title":"Build Types","text":"Value Description 0 Debug 1 Release 2 WebDemo 3 CdDemo"},{"location":"internal/randomFairySelection/","title":"Random Fairy Selection","text":"<p>There are two situations in the game where random fairies is chosen: for wild fairy encounters and for certain NPC's. Of course there is a strict set of rules as to still ensure a balanced games.</p>"},{"location":"internal/randomFairySelection/#fairy-groups","title":"Fairy groups","text":"<p>There are 33 sets of fairies which are identified by their index number. This id is used for the script command <code>W</code> (<code>defaultWizform</code>) and can also be found as second parameter of the <code>NpcAttackPosition</code> triggers. The group also defines the level range (with the LevelRangeId) the fairies can spawn at.</p> <p>These are the groups (if a fairy is listed twice, it is twice as likely to spawn):</p> GroupId FairyId FairyName LRId LevelRange 0 9 Worgot 5 3-3 26 Blumella 1 10 Corgot 13 9-11 75 Lana 2 57 Tinefol 36 26-34 1 Viteria 0 Silia 3 50 Pfoe 24 17-22 57 Tinefol 4 18 Abery 13 9-11 10 Corgot 5 9 Worgot 24 17-22 19 Abnobery 6 18 Abery 24 17-22 0 Silia 7 23 Cera 13 9-11 8 64 Goop 24 17-22 23 Cera 9 64 Goop 36 26-34 6 Tadana 10 6 Tadana 42 31-40 6 Tadana 24 Amnis 25 Ceramnis 11 20 Vesbat 5 3-3 20 Vesbat 12 62 Jumjum 13 9-11 20 Vesbat 13 4 Gremor 24 17-22 21 Stobat 14 3 Boneria 42 31-40 62 Jumjum 15 27 Mencre 13 9-11 28 Mensec 16 27 Mencre 24 17-22 47 Mentaur 17 27 Mencre 36 26-34 47 Mentaur 18 46 Beltaur 42 31-40 46 Beltaur 27 Mencre 19 12 Airia 36 26-34 13 Luria 20 41 Gorael 36 26-34 40 Sirael 21 54 Sirella 42 31-40 40 Sirael 22 55 Dracwin 42 31-40 55 Dracwin 23 31 Pix 54 40-52 31 Pix 32 Ferix 24 34 Feez 36 26-34 35 Greez 25 36 Greezloc 42 31-40 52 Glacess 26 15 Rasrow 24 17-22 37 Skelbo 27 15 Rasrow 36 26-34 37 Skelbo 28 15 Rasrow 42 31-40 53 Akrita 69 Manox 29 69 Manox 54 40-52 70 Turnox 29 Violectra 30 65 Minari 36 26-34 31 65 Minari 42 31-40 32 65 Minari 54 40-52 66 Megari 29 Violectra 33 72 Lighane 54 40-52 72 Lighane 73 Driane 43 Darbue"},{"location":"internal/randomFairySelection/#spells","title":"Spells","text":"<p>For selecting the spells a fairies gets, the game first determines the maximum spell cost for attack and support based on a level rank. Then it gets all spells of the same element type (ignoring the fairy's capabilities) and chooses at random.</p>"},{"location":"internal/randomFairySelection/#level-rank","title":"Level Rank","text":"<p>The level rank is calculated with an integer division (always round down) by 5, so examples: - <code>Level = 4  |  Rank =  4 / 5 = 0</code> - <code>Level = 9  |  Rank =  9 / 5 = 1</code> - <code>Level = 10 |  Rank = 10 / 5 = 2</code></p> <p>Then the maximum costs can be figured out by this table:</p> Rank Maximum Attack Cost Maximum Support Cost 0 1 n/a 1 1 n/a 2 1 1 3 2 1 4 2 2 5 2 2 6 3 2 7+ 3 3"},{"location":"internal/randomFairySelection/#levelrangeid","title":"LevelRangeId","text":"<p>The level selection based on the LevelRangeId follows this pseudocode:</p> <pre><code>int ampl = levelRangeId / 4;\nint base = levelRangeId - ampl - 1;\nint newLevel = base + rand() % ampl;\n</code></pre>"},{"location":"internal/script%20commands/fight/","title":"fight","text":"<p><code>fight</code> takes two numeric parameters and starts a duel. The parameters determine the arena the duel will take place in and whether the fight is against a single or multiple enemies. It can only be triggered as part of a dialog interaction.</p> <p>Its parameters are:</p> <ol> <li>The scene ID of the arena or <code>-1</code> (see below)</li> <li><code>0</code> for single enemy, <code>1</code> for multiple enemies</li> </ol> <p>Its short form is <code>*</code></p>"},{"location":"internal/script%20commands/fight/#multiple-enemies","title":"Multiple enemies","text":"<p>When the duel spans multiple enemies the enemies are chosen based on:</p> <ol> <li>They have to be NPCs</li> <li>They have to have at least one fairy</li> <li>They are at most 11 units away from the primary NPC</li> </ol>"},{"location":"internal/script%20commands/fight/#choosing-the-arena","title":"Choosing the arena","text":"<p>The scene ID of the arena can be chosen directly, if however it is <code>-1</code> it is chosen semi-randomly based on the level of the first fairy of the primary NPC and whether the fight is against multiple enemies.</p> Level-Range IDs for single enemy IDs for multiple enemies 0-25 220 1020 223 1023 229 1029 26-40 221 1021 224 1024 226 1026 230 1030 41-... 222 1022 225 1025 227 1027 228 1028"},{"location":"internal/script%20commands/givePlayerCards/","title":"givePlayerCards","text":"<p><code>givePlayerCards</code> takes three numerical parameters and adds a number of cards to the players inventory. Fairies are processed especially for starting spells and level.</p> <p>The parameters are:</p> <ol> <li>The number of cards to give</li> <li>The type of the cards (see CardId)</li> <li>The ID of the cards</li> </ol> <p>Its short form is <code>1</code>.</p>"},{"location":"internal/script%20commands/givePlayerCards/#fairy-based-on-v1010","title":"Fairy (based on v1.010)","text":"<p>The starting level and a first spell is based upon whether the player has any fairy in its deck. The starting level for a first fairy (in the deck) is 9 whilst for secondary fairies it is 3. The spells are more complicated:</p>"},{"location":"internal/script%20commands/givePlayerCards/#spells-for-first-fairies","title":"Spells for first fairies","text":"<p>The spell for a first fairy depends on its element class:</p> Class SpellID Spell-Name Nature 0 Small quake Water 10 Small waves Stone 30 Small stone other -1 Crashes the game"},{"location":"internal/script%20commands/givePlayerCards/#spells-for-secondary-fairies","title":"Spells for secondary fairies","text":"<p>A single active spell is chosen based on the fairies element class and a random level between 3-9 (inclusive), even though the level is fixed at 3. The method for chosing the spell is the same as for defaultWizform.</p> <p>TODO: Is there some point in the original game where a fairy is given with a spell assigned it should not be able to cast?</p>"},{"location":"internal/script%20commands/ifPlayerHasCards/","title":"ifPlayerHasCards","text":"<p><code>ifPlayerHasCards</code> is a control flow command that skips based on whether the player has certain items and/or a minimum number of them. The command takes three numerical parameters:</p> <ol> <li>Count of cards (see below)</li> <li>The type of the card (see CardId)</li> <li>The id of the card</li> </ol> <p>Its short form is <code>6</code>.</p>"},{"location":"internal/script%20commands/ifPlayerHasCards/#count","title":"Count","text":"<p>The count parameter has some pieces of special behavior:</p> <ul> <li>For items/spells</li> <li>if <code>count == 0</code> the condition is true if the player does not have the item/spell</li> <li>otherwise it is true if the player has at least <code>count</code> of that item/spell</li> <li>For fairies</li> <li>if <code>count == -1</code> the condition is true if the player has the fairy in their inventory</li> <li>else it is true if the player has that fairy type as first in the deck (always false for empty decks)</li> </ul>"},{"location":"internal/script%20commands/ifPlayerHasSpecials/","title":"ifPlayerHasSpecials","text":"<p><code>ifPlayerHasSpecials</code> is a control flow command that skips based on some special conditions that probably were built as-needed during development. It takes two numerical parameters:</p> <ol> <li>The type of condition (see below)</li> <li>Some argument</li> </ol> <p>The short-form is <code>@</code>.</p>"},{"location":"internal/script%20commands/ifPlayerHasSpecials/#condition-types","title":"Condition types","text":"Condition Description 0 Checks if player has at least 5 pixies.  Then also removes five pixies! 1 Checks whether the player has a fairy in the deck  <code>arg==0</code> for has not, <code>arg==1</code> for has 2 Checks whether the player has at least <code>arg</code> fairies 3 Checks whether the player has at least one fairy of element class <code>arg</code>"},{"location":"internal/script%20commands/lookAtPlayer/","title":"lookAtPlayer","text":"<p><code>lookAtPlayer</code> takes two numerical parameter and is used to let a NPC look at the player in a certain way and for a certain time. The NPC plays its <code>Idle0</code> animation during this command.</p> <p>Its parameters are:</p> <ol> <li>The time in tenths of a second</li> <li>The way the NPC looks toward the player:</li> </ol> Value Name Description -1 Idle The NPC does not look towards the player 1 Hard The NPC snaps on the XZ plane towards the player 2 Smooth The NPC rotates in a smooth motion on the XZ plane, the head snaps towards the player 3 Billboard The NPC snaps on all axes towards the player <p>Its short-form is <code>+</code>.</p>"},{"location":"internal/script%20commands/modifyWizform/","title":"modifyWizform","text":"<p><code>modifyWizform</code> changes the fairy it was triggered on in some way determined by its parameters. It can only be used in item scripts.</p> <p>Its parameters are:</p> <ol> <li>The category of change to execute</li> <li>Some value related to the change</li> </ol> Category Name Description 0 Heal Heals the fairies by the given amount (only if it is alive) 1 AddXP Adds a given amount of XP (only used by the cut item \"Amulet of Experience\") 2 ClearStatusEffects Removes status effects like posioned, frozen, burned 7 Transform Changes the fairy type to the given id (e.g. as used by evolution stones or dwarven tool) 8 AddNearLevelXP Adds XP to be one less than for the next level 9 Set Unknown Sets an unknown fairy value (unused) 10 Set Unknown Sets an unknown fairy value (unused) 11 Set Unknown Sets an unknown fairy value (unused) 12 Set Unknown Sets an unknown fairy value (unused) 13 Set Unknown Sets an unknown fairy value (unused) 14 Add Unknown Adds the arg to some unknown fairy value (unused) 16 Revive Revives the fairy and heals a third of the max HP 17 Fill Mana Sets the mana of every spell to max 18 Rename Renames a fairy <p>Its short-form is <code>:</code>.</p>"},{"location":"internal/script%20commands/removeNpc/","title":"removeNpc","text":"<p>The script command <code>removeNpc</code> takes no parameter, its short form is <code>-</code>. It adds a new GSModDisableTrigger to the scene to persist the removing and then removes itselfs from the world. As it can be executed in implementation 1 as well as 3 it may also close the current dialog.</p>"},{"location":"internal/script%20commands/removePlayerCards/","title":"removePlayerCards","text":"<p><code>removePlayerCards</code> takes three numerical parameter and is used to remove cards from the players inventory. It can only be used for script 1, 4 and 5 of NPCs.</p> <p>This command is buggy for spells and fairies, instead of removing some number of cards it removes every card of the selected type and id (e.g. instead of removing one Silia it would be remove all Silia fairies).</p> <p>Its parameters are:</p> <ol> <li>The number of cards to remove</li> <li>The card type</li> <li>The card id</li> </ol> <p>Its short-form is <code>9</code>.</p>"},{"location":"internal/script%20commands/say/","title":"say","text":"<p>The script command <code>say</code> is allowed when triggering NPCs and takes two parameters:</p> <ul> <li>A foreign key to a dialog row</li> <li>A numeric flag I call silent</li> </ul> <p>When executed the text in the dialog row is displayed gradually at the bottom of the screen in a letterbox. The silent flag does two things:</p> <ol> <li>blinking symbol appears after the text has been displayed fully</li> <li>a voice sample is played</li> </ol> <p>The voice sample may come from the <code>Voice</code> column in the dialog row, but it isn't used in the original database. Alternatively the game appends at random a number between 1 and 3 to the model name and plays thereby choosen sample.</p> <p>Its short form is <code>!</code>.</p>"},{"location":"internal/script%20commands/setCamera/","title":"setCamera","text":"<p><code>setCamera</code> takes only a single numeric parameter, which determines where the camera should be located. As this command is only allowed for scriptsystem implementation 1 and 3, therefore there is always a Npc to reference.</p> <p>Its single-character version is <code>&amp;</code></p> Value Description 00XX at CameraPosition trigger XX (look at player) 1000 behind player (left top) 1001 behind player (left bottom) 1002 behind player (left center) 1003 behind player (right top) 1004 behind player (right bottom) 1005 behind player (right center) 1006 behind player (directly) 1007 front of player (directly) 2000 behind Npc (left top) 2001 behind Npc (left bottom) 2002 behind Npc (left center) 2003 behind Npc (right top) 2004 behind Npc (right bottom) 2005 behind Npc (right center) 2100 follow Npc 30XX at CameraPosition trigger XX (use trigger direction) 4000 look at Npc 50XX at CameraPosition trigger XX (look at Npc)"},{"location":"internal/script%20commands/setupGambling/","title":"setupGambling","text":"<p><code>setupGambling</code> adds chances to a specific card or blank into the gambling result list. The actual percentage chance for a card/blank therefore depends on how many duplicates of it are in the list and the total number of entries in the gambling list (e.g. for a list <code>[A, A, A, B, B, B, B, C, D, E]</code> the chance for <code>A</code> is <code>3/10</code>).</p> <p>The parameters are:</p> <ol> <li>The number of entries to put into the gambling list</li> <li>The type of the card (see CardId), or <code>3</code> for blank (see also below)</li> <li>The ID of the card</li> </ol> <p>The short form is <code>B</code></p>"},{"location":"internal/script%20commands/setupGambling/#blanks","title":"Blanks","text":"<p>The decreasing blank chance when the player has clover leaf item is implemented into this command. If the player has it there is a 80% chance per entry that it will not be added to the gambling list.</p>"},{"location":"internal/script%20commands/spell/","title":"spell","text":"<p><code>spell</code> take three numeric parameters, adds a spell to the inventory and assigns the spell to a specific spell slot of a fairy in the deck. It can only be used with NPCs.</p> <p>Its parameters are:</p> <ol> <li>The deck slot of the fairy (0-4 incl.)</li> <li>The spell slot (0-3 incl.)</li> <li>The ID of the spell</li> </ol> <p>Keep in mind that this does not check for active/passive spells, you should only put active spells into slots 0 and 2 and only put passive spells into slots 1 and 3!</p> <p>Its short form is <code>(</code></p>"},{"location":"internal/script%20commands/wizform/","title":"wizform","text":"<p><code>wizform</code> takes three numeric parameter, adds a fairy at a specific level into the inventory and sets the fairy into a slot in the deck. It can only be used with NPCs.</p> <p>The parameters are:</p> <ol> <li>The slot were the new fairy is put (0-4 incl.)</li> <li>The ID of the new fairy</li> <li>The level of the new fairy</li> </ol> <p>Its short form is <code>'</code></p>"},{"location":"resources/","title":"File format summary","text":"<p>As one can imagine, ZanZarah uses many different file formats for its resources. This file should give an overview and link to a detail page for them all.</p>"},{"location":"resources/#rwbs","title":"RWBS","text":"<p>Renderware Binary Stream files are not really actual files, but rather a general format structure which is use by DFF as well as BSP to store hierachical data. As the name states, this format was developed by Criterion Software for Renderware.</p>"},{"location":"resources/#dff","title":"DFF","text":"<p>DFF files are used to store meshes and are generally structured by the RWBS system. They contain geometry, materials, collision data, skinning and bone data. They do not contain most of the animation data and no texture data. This format was developed by Criterion Software for Renderware.</p>"},{"location":"resources/#bsp","title":"BSP","text":"<p>BSP (Binary Space Partition) are used to store different world geometry and collision data. They use the RWBS format. Like DFF files they do not contain texture data. This format was developed by Criterion Software for Renderware.</p>"},{"location":"resources/#ska","title":"SKA","text":"<p>SKA (Skeletal Animation) files are used to store model animations. This format was like the RWBS file formats developed by Criterion Software for Renderware but they do not follow the RWBS file structure.</p>"},{"location":"resources/#ed","title":"ED","text":"<p>ED (Effect description) files are used to describe various effects. This format was developed by Funatics Entertainment for ZanZarah.</p>"},{"location":"resources/#fbs","title":"FBS","text":"<p>FBS files are used to store various numeric and/or textual data about various aspects of the gameplay. They store information about the texts displayed in the game, fairy, spell, item and NPC information. They are the biggest source for Scripts. This format was developed by Funatics Entertainment for ZanZarah.</p>"},{"location":"resources/#aed","title":"AED","text":"<p>AED (actorex description) files are used to combine the body mesh files with the wing mesh files and the animation files for both of them. The format was developed by Funatics Entertainment for ZanZarah.</p>"},{"location":"resources/#scn","title":"SCN","text":"<p>SCN (scene) files are used to describe a scene. This does include a reference to the BSP file but also contains various other informations like models placed in the world, triggers, sound or graphical effects, etc.</p>"},{"location":"resources/#dat","title":"DAT","text":"<p>DAT (data) files are used to store a state of the game, so the player does not have to play all over again. Shocking, isn't it?</p>"},{"location":"resources/#cfg","title":"CFG","text":"<p>Unfortunately there exists three different CFG formats which all are incompatible to each other:</p> Link Files Description  [x]  Configs/game.cfg This file stores the game settings including input bindings  [x]  System/map.cfg This file stores various map markers  [x]  System/ai.cfg  System/net.cfg  System/wizform.cfg These files store numeric variables, propably used to test and tweak the game during development"},{"location":"resources/#raw","title":"RAW","text":"<p>There exists only one file with the extension RAW, it stores which pixel of the map texture correspond to the different world sections.</p>"},{"location":"resources/AED/","title":"AED","text":"<p>ActorEx Description (AED) files are in Zanzarah mappings between body model, optional wings model and a set of animations per part. It is developed by Funatics, seen by the similar format for scene files.</p>"},{"location":"resources/AED/#data-format","title":"Data Format","text":"<ul> <li>The first zstring in an AED file is <code>[ActorExDescriptionFile]</code></li> <li>After this there is a sequence of sections all started by a zstring containing the name in square brackets.</li> <li>Each section has his own data format.</li> <li>The end of the file is signaled by the section header <code>[EOS]</code> which does not have any other information.</li> </ul>"},{"location":"resources/AED/#sections","title":"Sections","text":"SectionName Dataformat Description ModelFilename_Body zstring The DFF file for the body AnimationPoolID_Body int32 An unused ID for the animation pool AnimationFilename_Body zstring + enum A SKA in the body animation pool and its AnimationType ModelFilename_Wings zstring The DFF file for the (optional) wings AnimationPoolID_Wings int32 An unused ID for the animation pool AnimationFilename_Wings zstring + enum A SKA in the wings animation pool and its AnimationType AttachWingsToBone int32 The bone ID of the body to attach the wings root bone to HeadBoneID int32 The root head bone ID, usage yet to be known EffectBoneID int32 The bone ID to attach a possible actor effect to"},{"location":"resources/AED/#animationtype","title":"AnimationType","text":"Value Name 0 Idle0 1 Jump 2 Run 3 RunForwardLeft 4 RunForwardRight 5 Back 6 Dance 7 Fall 8 Rotate 9 Right 10 Left 11 Idle1 12 Idle2 13 Talk0 14 Talk1 15 Talk2 16 Talk3 17 Walk0 18 Walk1 19 Walk2 20 SpecialIdle0 21 SpecialIdle1 22 SpecialIdle2 23 FlyForward 24 FlyBack 25 FlyLeft 26 FlyRight 27 Loadup 28 Hit 29 Joy 30 ThudGround 31 UseFairyPipe 32 UseSeaShel 33 Smith 34 Astonished 35 Surprise0 36 Surprise1 37 Stop 38 ThudGround2 39 PixieFlounder 40 JumpHigh"},{"location":"resources/BSP/","title":"BSP","text":"<p>Binary Space Partition files are used to store information about scene geometry, their materials and the respective collision data. Therefore the file inherits a recursive structure which is encoded using the RWBS format.</p>"},{"location":"resources/BSP/#data-format","title":"Data format","text":"<p>Please see the RWBS articles.</p>"},{"location":"resources/BSP/#common-rwbs-structure","title":"Common RWBS structure","text":"<ul> <li>1 World<ul> <li>1 MaterialList<ul> <li>1-N Material<ul> <li>1 Texture</li> </ul> </li> </ul> </li> <li>1 PlaneSection or AtomicSection<ul> <li>2 PlaneSection or AtomicSection</li> <li>for AtomicSection<ul> <li>1 Extension<ul> <li>1 BinMeshPLG</li> <li>1 CollisionPLG</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"resources/DAT/","title":"DAT","text":"<p>Savegames stored in DAT files consist of various sections. The main parts of it are the GameState and the Inventory. Also the GlobalVars are saved here.</p>"},{"location":"resources/DAT/#data-format","title":"Data format","text":"Size Type Section Description ZZVersion Header This version has to be compatible with the internal savegame ZZVersion structure zstring Header The players name 4B uint Location The structure size of the location block (always 8) 4B uint Location Scene ID 4B uint Location Entrance Trigger ID 4B uint GameState Count of scenes for which are GameState Modifier saved GameStateScene[] GameState The scene data 4B uint Inventory The count of cards in the players inventory InventoryCard[] Inventory The inventory card data 4B uint PixieCount The current amount of pixies hold on by the player 4B uint PixieCount The total amount of pixies catched by the player 4B uint GlobalVars The count of global variables (always 49) GlobalVar[] GlobalVars The global variables 4B uint SwitchGameMinTries The minimal count of tries for the switch game"},{"location":"resources/DAT/#gamestatescene","title":"GameStateScene","text":"Size Type Description zstring The scene name 4B uint The GameState modifier count for this scene GameStateMod[] The GameState modifiers"},{"location":"resources/DAT/#gamestatemod","title":"GameStateMod","text":"Size Type Description 4B enum The type of the GameStateMod (see GameStateModType) GameStateModType specific data"},{"location":"resources/DAT/#gamestatemodtype","title":"GameStateModType","text":"Value Description 0 DisableAttackTrigger 1 RemoveItem 2 ChangeNpcState 3 DisableTrigger 4 RemoveSimpleModel 5 SetTrigger 6 SetNpcModifier"},{"location":"resources/DAT/#gsmoddisableattacktrigger","title":"GSModDisableAttackTrigger","text":"Size Type Description 4B uint triggerId"},{"location":"resources/DAT/#gsmodremoveitem","title":"GSModRemoveItem","text":"Size Type Description 4B uint modelId"},{"location":"resources/DAT/#gsmodchangenpcstate","title":"GSModChangeNpcState","text":"Size Type Description 4B uint triggerId 4B uint databaseId - The fb0x05 UID of the NPC to change into"},{"location":"resources/DAT/#gsmoddisabletrigger","title":"GSModDisableTrigger","text":"Size Type Description 4B uint triggerId"},{"location":"resources/DAT/#gsmodremovesimplemodel","title":"GSModRemoveSimpleModel","text":"Size Type Description 4B uint modelId"},{"location":"resources/DAT/#gsmodsettrigger","title":"GSModSetTrigger","text":"Size Type Description 4B uint triggerId 4B uint ii1 - The trigger parameters 4B uint ii2 - If one of these are -1 4B uint ii3 - this said parameter is not set 4B uint ii4"},{"location":"resources/DAT/#gsmodsetnpcmodifier","title":"GSModSetNpcModifier","text":"Size Type Description 4B uint triggerId 4B uint value - Actually just sets the triggers ii2 param"},{"location":"resources/DAT/#inventorycard","title":"InventoryCard","text":"Size Type Description 4B CardId The CardId, thus also encodes the type 4B uint atIdx - The index at which Zanzarah puts this card in the internal inventory list 4B uint dbUID - The database ID (so either fb0x01, fb0x03 or fb0x04) of the card 4B uint amount 1B bool isUsed InventoryCard-specific data"},{"location":"resources/DAT/#inventoryitem","title":"InventoryItem","text":"<p>Items do not have any extra information</p>"},{"location":"resources/DAT/#inventoryslot","title":"InventorySlot","text":"Size Type Description 4B uint usageCount - How many times this spell was used 4B uint curMana"},{"location":"resources/DAT/#inventoryfairy","title":"InventoryFairy","text":"Size Type Description 4B uint changeCountLevel - How many times this fairy leveled up 4B uint level 4B uint unknown 4B uint unknown 4B uint changeCountXP - How many times this fairy got XP 4B uint curXP 12B SpellReq[4] The current spell requirements 16B uint[4] The spell indices (in the inventory of the player) 4B uint The slot index in the players deck 4B uint statusEffect 20B uint[5] unknown 4B uint Current health points zstring name"},{"location":"resources/DAT/#spellreq","title":"SpellReq","text":"Size Type Description 1B enum class1 - (see Classes) 1B enum class2 - (see Classes) 1B enum class3 - (see Classes)"},{"location":"resources/DFF/","title":"DFF","text":"<p>DFF files are used to store information about models, static or actors. Therefore they not only contain geometry and material information but also information about animations, bones and skinning. They are structured in the RWBS format.</p>"},{"location":"resources/DFF/#data-format","title":"Data format","text":"<p>Please see the RWBS articles.</p>"},{"location":"resources/DFF/#common-structure","title":"Common structure","text":"<ul> <li>1 Clump<ul> <li>1 FrameList<ul> <li>1-n Extension<ul> <li>0-1 AnimationPLG</li> </ul> </li> </ul> </li> <li>1 GeometryList<ul> <li>1 Geometry<ul> <li>1 MaterialList<ul> <li>1-n Material<ul> <li>1 Texture</li> </ul> </li> </ul> </li> <li>1 Extension<ul> <li>1 BinMeshPLG</li> <li>1 MorphPLG</li> </ul> </li> </ul> </li> </ul> </li> <li>1 Atomic<ul> <li>1 Extension<ul> <li>1 SkinPLG</li> </ul> </li> </ul> </li> <li>1 Extension<ul> <li>1 AnimationPLG</li> </ul> </li> </ul> </li> </ul>"},{"location":"resources/SKA/","title":"SKA","text":"<p>SKA files are used to describe animations of actors. Despite the data format being developed by Criterion Software for Renderware, the file does not inherit the RWBS format.</p>"},{"location":"resources/SKA/#data-format","title":"Data format","text":"Size Type Description 4b uint number of frames 4b uint flags unused 4b float duration KeyFrame[] the frames"},{"location":"resources/SKA/#keyframe","title":"KeyFrame","text":"Size Type Description 16b Quaternion Bone rotation 12b Vector Bone position 4b float time 4b uint data offset of parent frames"},{"location":"resources/CFG/CFG_Map/","title":"Map markers (map.cfg)","text":"<p>map.cfg stores various map markers, unfortunately there exists another internal but similar map marker list. The relationship between those two has yet to be analysed.</p>"},{"location":"resources/CFG/CFG_Map/#format","title":"Format","text":"Size Type Description 4B uint count of map markers MapMarker[] the array of map markers"},{"location":"resources/CFG/CFG_Map/#mapmarker","title":"MapMarker","text":"Size Type Description 4B int X position on the map 4B int Y position on the map 4B enum section of the marker (see sections) 4B uint scene id of the marker"},{"location":"resources/CFG/CFG_Map/#section","title":"Section","text":"Value Name 1 FairyGarden 2 EnchantedForest 3 MountainWorld 4 DarkSwamp 5 ShadowRealm 6 RealmOfClouds 7 London"},{"location":"resources/CFG/CFG_Map/#ingame-display","title":"Ingame display","text":"<p>The color bitmap of the map displayed in the game is stored in BITMAPS/MAP001T.BMP, but the game shows sections only if the player has the respective item. The information what pixels to draw is stored in BITMAPS/MAP001M.RAW which is an array of bytes with size 640*480, where each byte is a section number.</p> <p>The map markers stored in map.cfg are not always shown but the scene name is shown upon hovering the mouse near a marker (in a circle with radius 50px).</p>"},{"location":"resources/CFG/CFG_Vars/","title":"Tweak variables (ai.cfg / wizform.cfg / net.cfg)","text":"<p>These config files store variables which are either a floating point number or a string. The binary format is a bit unnecessary complicated and the actual use of the variables is yet to be known.</p>"},{"location":"resources/CFG/CFG_Vars/#format","title":"Format","text":"Size Type Description 16B MD5 A MD5 hash of the current file starting at the first named variable 3B uint unknown header CfgValue unknown first value (see CfgValue) CfgVariable[] array of variables to the end of the file (see CfgVariable)"},{"location":"resources/CFG/CFG_Vars/#cfgvariable","title":"CfgVariable","text":"Size Type Description 1B uint size of name string char[] name string, but every character is XOR'ed with 0x75 1B char zero byte (as end character for the name) CfgValue value of the variable"},{"location":"resources/CFG/CFG_Vars/#cfgvalue","title":"CfgValue","text":"Size Type Description 4B float numeric value (of the variable) 1B uint size of the string value, if &gt; 0 the numeric value is set to 0.0 char[] value string 1B char ignored end byte (in the most cases 0)"},{"location":"resources/FBS/","title":"Basic information","text":"<p>FBS files are used to store various numeric and/or textual data about various aspects of the gameplay. They store information about the texts displayed in the game, fairy, spell, item and NPC information. They are the biggest source for scripts. This format was developed by Funatics Entertainment for ZanZarah.</p>"},{"location":"resources/FBS/#data-format","title":"Data format","text":"<p>There are actually two types of FBS files: the one whose only file is called \"_fb0x00.fbs\" and all the other files. The first one is the database index file, it stores all column names and some number which doesn't seem to be used and is the same for all columns.</p> Size Type Description 4b uint number of column data Column[] the columns"},{"location":"resources/FBS/#column","title":"Column","text":"Size Type Description 4b uint type zstring name of the column <p>The other database files store the actual row data, but every row has its indivitually sized array of columns and data type it stores in those columns. Every row has at least an uid column which is therefore not even mentioned in the index file.  Unfortunately the column index stored in the row data is not always correct, but the order of row data is for one database always the same.</p> Size Type Description 4b uint number of rows Row[] row data"},{"location":"resources/FBS/#row","title":"Row","text":"Size Type Description 4b uint UID of row 4b uint number of filled columns ColumnData[] the data"},{"location":"resources/FBS/#columndata","title":"ColumnData","text":"Size Type Description 4b enum data type 4b uint the column index This is eiter zstring, 4b uint, 1b uint, UUID or Buffer"},{"location":"resources/FBS/#data-type-enum","title":"data type enum","text":"Name Value String 0 Uint 1 UUID 3 Byte 4 Buffer 5"},{"location":"resources/FBS/#uuid","title":"UUID","text":"Size Type Description 4b uint unused 4b uint uid 4b uint type"},{"location":"resources/FBS/#buffer","title":"Buffer","text":"Size Type Description 4b uint size 1b uint[] data"},{"location":"resources/FBS/#the-content","title":"The content","text":"Filename Description fb0x00 The index file fb0x01 Fairies fb0x02 Strings fb0x03 Spells fb0x04 Items fb0x05 NPCs fb0x06 Dialog lines"},{"location":"resources/FBS/fb0x01/","title":"Fairies (fb0x01)","text":"<p>This file contains information about the fairies.</p>"},{"location":"resources/FBS/fb0x01/#columns","title":"Columns","text":"Idx Name Description 0 Mesh A string containing the mesh file 1 Name A foreign key UID to fb0x02 containing the name 2 Class0 An integer between 0 and 12, signifies the element class 3 CardId The unique identifier between fairies, spells and items, see CardId 4 unknown A column that suits its name, it is zero for all fairies and thus can propably be ignored 5-15 Level0-9 A first (spell) level data, see this table about their values 16 Info A foreign key UID to fb0x02 containing a descriptive text 17 MHP An integer containing some base hitpoint count 18 EvolCId An integer containing either -1 or the ID of the fairy this one evolves into 19 EvolVar An integer containing either -1 or the Level at which the fairy evolves 20 MovSpeed An integer containing some base movement speed 21 JumpPower An integer containing some base jump height factor 22 CriticalHit An integer propably pointing to a critical hit damage pointer 23 Sphere The meaning of this column is yet to be known 24 LevelUp As well as this 25 Voice An integer used in the generation of some sound filenames 26 Class1 An integer between 0 and 6 containing some unknown information"},{"location":"resources/FBS/fb0x01/#class-order","title":"Class order","text":"<p>The order of classes which thus points to the value of Class0 is as following:</p> <ol> <li>Nature</li> <li>Air</li> <li>Water</li> <li>Light</li> <li>Energy</li> <li>Psi</li> <li>Rock</li> <li>Ice</li> <li>Fire</li> <li>Night</li> <li>Chaos</li> <li>Metal</li> </ol>"},{"location":"resources/FBS/fb0x01/#level-section-data","title":"Level section data","text":"<p>Level0 to Level9 can be split up into 5 different numbers:</p> Bitrange Description 0-3 First class of spell requirement (always equal to Class0) 4-7 Second class of spell requirement 8-11 Third class of spell requirement 12-14 Spell slot index 16-31 Level from which this data applies <p>A spell requirement of 13 means every class fits (joker class), 0 means no requirement.  The game uses this data to determine the spell requirements of a fairy from a specific level on.</p>"},{"location":"resources/FBS/fb0x01/#order","title":"Order","text":"<p>The following order can be extracted from the CardId values:</p> <ol> <li>Silia</li> <li>Viteria</li> <li>Boneria</li> <li>Grem</li> <li>Gremor</li> <li>Gremrock</li> <li>Tadana</li> <li>Aquana</li> <li>Oceana</li> <li>Worgot</li> <li>Corgot</li> <li>Symgot</li> <li>Airia</li> <li>Luria</li> <li>Laticia</li> <li>Rasrow</li> <li>Maulrow</li> <li>Psyrow</li> <li>Abery</li> <li>Abnobery</li> <li>Vesbat</li> <li>Stobat</li> <li>Garbat</li> <li>Cera</li> <li>Amnis</li> <li>Ceramnis</li> <li>Blumella</li> <li>Mencre</li> <li>Mensec</li> <li>Violectra</li> <li>Biolectra</li> <li>Pix</li> <li>Ferix</li> <li>Daemonex</li> <li>Feez</li> <li>Greez</li> <li>Greezloc</li> <li>Skelbo</li> <li>Skeljaw</li> <li>Skelrath</li> <li>Sirael</li> <li>Gorael</li> <li>Fathrael</li> <li>Darbue</li> <li>Bue</li> <li>Lighbue</li> <li>Beltaur</li> <li>Mentaur</li> <li>Clum</li> <li>Clumaur</li> <li>Pfoe</li> <li>Taze</li> <li>Glacess</li> <li>Akritar</li> <li>Sirella</li> <li>Dracwin</li> <li>Flagwin</li> <li>Tinefol</li> <li>Tinerog</li> <li>Tinezard</li> <li>Tineves</li> <li>Fygaery</li> <li>Jumjum</li> <li>Jumrock</li> <li>Goop</li> <li>Minari</li> <li>Megari</li> <li>Gigarex</li> <li>Segbuzz</li> <li>Manox</li> <li>Turnox</li> <li>Dredanox</li> <li>Lighane</li> <li>Driane</li> <li>Suane</li> <li>Lana</li> <li>Liana</li> </ol>"},{"location":"resources/FBS/fb0x02/","title":"Strings (fb0x02)","text":"<p>The second database file contains all localized strings except dialog text.</p>"},{"location":"resources/FBS/fb0x02/#columns","title":"Columns","text":"Idx Name Description 0 Text Contains the actual text 1 Group Contains an integer between 0 and 15 see groups 2 Define Contains a string uniquely describing this text among all others, propably not used by the game"},{"location":"resources/FBS/fb0x02/#groups","title":"Groups","text":"<p>The text entries are sorted into categories, at least group 3 (Credits) is used in a special way.</p> Value Name 0 WizForm - Names 1 Spell - Names 2 Items - Names 3 Credits 4 Menus 5 Npc - Names 6 unused 7 Scene Names 8 Signs 9 Item - Descriptions 10 Spell Descriptions 11 WizForm - Descriptions 12 Help 13 Dance Descriptions 14 Start Dialog 15 Class Group"},{"location":"resources/FBS/fb0x03/","title":"Spells (fb0x03)","text":"<p>The third database file describes all spells in the game.</p>"},{"location":"resources/FBS/fb0x03/#columns","title":"Columns","text":"Idx Name Description 0 Name A foreign key UID to fb0x02 containing the name of the spell 1 Type An integer either 0 for attack spell or 1 for support spell 2 CardId The unique identifier between fairies, spells and items, see CardId 3 PriceA An integer between 0 and 12 describing the first usage requirement (see class order) 4 PriceB An integer between 0 and 12 describing the second usage requirement (see class order) 5 PriceC An integer between 0 and 12 describing the third usage requirement (see class order) 6 Info A foreign key UID to fb0x02 containing a descriptive text for the spell 7 Mana An integer between 0 and 5 defining the amount of mana this spell has (see mana amount table) 8 Loadup An integer between 0 and 4 defining the speed at which this spell can be load up (no further details known yet) 9 unknown This integer column is always 0 and thus can propably be ignored 10 MissileEffect An integer either containing -1 or the part of an effect filename 11 ImpactEffect An integer either containing -1 or the part of an effect filename 12 Damage An integer between 0 and 4 defining the base damage this spell does (no further details known yet) 13 Behavior An integer pointing to the special Behavior this spell has (see Behavior tables)"},{"location":"resources/FBS/fb0x03/#mana-amount-table","title":"Mana amount table","text":"Value Actual amount 0 5 1 15 2 30 3 40 4 50 5 Unlimited"},{"location":"resources/FBS/fb0x03/#behavior","title":"Behavior","text":"<p>This column value is an index to an internal array which defines its support or critical hit spell Behavior depending of its type:</p>"},{"location":"resources/FBS/fb0x03/#support-behavior","title":"Support Behavior","text":"Index Name (Internal) 0 no support Behavior 1 20% less damage 2 50% less damage 3 80% less damage 4 no damage 5 20% more damage 6 40% more damage 7 60% more damage 8 80% more damage 9 100% more damage 10 20% more damage in case of a critical hit 11 40% more damage in case of a critical hit 12 60% more damage in case of a critical hit 13 80% more damage in case of a critical hit 14 100% more damage in case of a critical hit 15 20% more damage in case of a critical hit 16 40% more damage in case of a critical hit 17 60% more damage in case of a critical hit 18 80% more damage in case of a critical hit 19 100% more damage in case of a critical hit 20 20% faster spell loadup 21 40% faster spell loadup 22 60% faster spell loadup 23 80% faster spell loadup 24 100% faster spell loadup 25 20% more cirtical hit probability 26 40% more cirtical hit probability 27 60% more cirtical hit probability 28 80% more cirtical hit probability 29 100% more cirtical hit probability 30 15% faster movement 31 30% faster movement 32 45% faster movement 33 60% faster movement 34 75% faster movement 35 20% faster jump power loadup 36 40% faster jump power loadup 37 60% faster jump power loadup 38 80% faster jump power loadup 39 100% faster jump power loadup 40 Heal 1 hitpoint 41 Heal 5 hitpoint 42 Heal 10 hitpoint 43 Heal 20 hitpoint 44 Heal 50 hitpoint 45 Critical hits have no effect 46 Transform damagepoints at the enemy to hitpoints at the own puppet 47 Reflect damage 48 Use support spell instead off jumppower 49 Can't be poison 50 Can't be frozen 51 Can't be silent 52 Can't be curse 53 Can't be burn 54 No conditions"},{"location":"resources/FBS/fb0x03/#critical-hit-behavior","title":"Critical hit Behavior","text":"Index Name (Internal) 0 No critical hit Behavior 1 20% More damage at enemy 2 40% More damage at enemy 3 60% More damage at enemy 4 80% More damage at enemy 5 100% More damage at enemy 6 Produce 5 hitpoints 7 Produce 10 hitpoints 8 Produce 25 hitpoints 9 Produce 30 hitpoints 10 Produce 50 hitpoints 11 20% Slower movement 12 40% Slower movement 13 60% Slower movement 14 80% Slower movement 15 100% Slower movement 16 20% Slower spell loadup 17 40% Slower spell loadup 18 60% Slower spell loadup 19 80% Slower spell loadup 20 100% Slower spell loadup 21 50% Less jump power 22 100% Less jump power 23 20% Less mana 24 40% Less mana 25 60% Less mana 26 80% Less mana 27 100% Less mana 28 No attack spells 29 No support spell 30 Disable jumping 31 Spin 32 Set condition poison 33 Set condition burn 34 Set condition curse 35 Set condition frozen 36 Set condition silent 37 No critical hits 38 Instant spell burst 39 Enemy take own damage 40 Invert control 41 Teleport enemy 42 No view"},{"location":"resources/FBS/fb0x03/#order","title":"Order","text":"<ol> <li>Small Quake</li> <li>Falling Tree</li> <li>Razor Blade</li> <li>Light Spurs</li> <li>Large Root</li> <li>Storm</li> <li>Powerless Spirit</li> <li>Storm Arrow</li> <li>Tornado</li> <li>Great Displacement</li> <li>Small Waves</li> <li>Hail of Needles</li> <li>Hail of Knives</li> <li>Slight Insanity</li> <li>Call of the Water</li> <li>Reflection</li> <li>Bundled Light</li> <li>Light Arrow</li> <li>Surge of Light</li> <li>Enchanted Light</li> <li>No Discharge</li> <li>Chain Reaction</li> <li>Time Shift</li> <li>Exiled Power</li> <li>Burning Spear</li> <li>Small Spirit</li> <li>Insanity</li> <li>Heavy Thoughts</li> <li>Psi Wave</li> <li>Great Telekinesis</li> <li>Small Stone</li> <li>Flying Rock</li> <li>Falling Rocks</li> <li>Hail of Stones</li> <li>Meteor</li> <li>Ball of Ice</li> <li>Ice Arrow</li> <li>Frost Ray</li> <li>Frozen Spirit</li> <li>Great Hail of Ice</li> <li>Flame</li> <li>Fire Arrow</li> <li>Ball of Fire</li> <li>Burning Hands</li> <li>Burning Souls</li> <li>Darkness</li> <li>Solar Eclipse</li> <li>Arrow of Darkness</li> <li>Ball of Darkness</li> <li>Soul Thief</li> <li>Chaos Lightning</li> <li>Chaos Arrow</li> <li>Spirit of Chaos</li> <li>Burn Out</li> <li>Ball of Chaos</li> <li>Metal Pin</li> <li>Metal Arrow</li> <li>Pins &amp; Needles</li> <li>Magnetism</li> <li>Heavy Metal</li> <li>Birch Skin</li> <li>Oak Skin</li> <li>Sharp Eye</li> <li>Thorn Armour</li> <li>Untouchable</li> <li>Storm</li> <li>Tornado</li> <li>Upward Wind</li> <li>Geysir</li> <li>Hurricane</li> <li>Slight Healing</li> <li>Healing Power</li> <li>Shapeless Power</li> <li>Smooth as Glass</li> <li>Sorrow Shared</li> <li>Power of Light</li> <li>Kiss of Light</li> <li>Painful Charge</li> <li>Lucky Dip</li> <li>Shelter of the Light</li> <li>Targeted Damage</li> <li>Homesickness</li> <li>Dubious Luck</li> <li>View Enhancer</li> <li>Magic Awakening</li> <li>Telekiness</li> <li>Unwavering Spirit</li> <li>Quake of Power</li> <li>Migration of Souls</li> <li>Spiritual Power</li> <li>Flying Stones</li> <li>Stone Spear</li> <li>Stone Skin</li> <li>Magic Guidance</li> <li>Unintentional Movement</li> <li>Magic River</li> <li>Magic Support</li> <li>Severity</li> <li>Jump Magic</li> <li>Absorb Mana</li> <li>Magic Breath</li> <li>Magic Touch</li> <li>Rusty Shield</li> <li>Quick Thinking</li> <li>Magic Shield</li> <li>Bruiser</li> <li>Magic Support</li> <li>Frozen</li> <li>Flying Feet</li> <li>Flyweight</li> <li>Dance of Chaos</li> <li>Creeping Chaos</li> <li>Confused Spirit</li> <li>Devil's Wings</li> <li>Heat Shimmers</li> <li>Liquid Metal</li> <li>Scorching Steel</li> <li>Old Armour</li> <li>Speed of Light</li> <li>Rusty Spear</li> </ol>"},{"location":"resources/FBS/fb0x04/","title":"Items (fb0x04)","text":"<p>The fourth database file is used to store information about the items obtainable or not, as there are a couple of items which are not used in the game and do not even have a german translation.</p>"},{"location":"resources/FBS/fb0x04/#columns","title":"Columns","text":"Idx Name Description 0 Name A foreign key UID to fb0x02 containing the name of the item 1 CardId The unique identifier between fairies, spells and items, see CardId 2 Info A foreign key UID to fb0x02 containing a descriptive text for the item 3 Special Should propably an integer between 0 and 1 determining whether the script could be used, but it is 1 for all items 4 Script A script using implementation 2, it is executed when used on a fairy 5 unknown An integer between 0 and 2 maybe used for sorting but this not confirmed yet"},{"location":"resources/FBS/fb0x04/#order","title":"Order","text":"<ol> <li>Small Health</li> <li>Medium Health</li> <li>Large Health</li> <li>Healing Leaf</li> <li>Fairy Coin</li> <li>Test Amulet</li> <li>Crystal</li> <li>Medicine</li> <li>Fairy Horn</li> <li>Amulet of Experience</li> <li>Clover Leaf</li> <li>Test Amulet</li> <li>Reserved Magic Card</li> <li>Golden Carrot</li> <li>Reserved Magic Card</li> <li>Ocean Conch</li> <li>Pixie Bag</li> <li>Silver Sphere</li> <li>Golden Sphere</li> <li>Crystal Sphere</li> <li>Garlic Atomizer</li> <li>Catacomb Key</li> <li>Heavy Iron Key</li> <li>Key of the guardian of Pixies</li> <li>Rufus House Key</li> <li>Key to Dwarf Factory</li> <li>Quilin's Staff Of Rule</li> <li>Key to the Town Hall</li> <li>Rune of return</li> <li>Rune of the Fairy Garden</li> <li>Rune of Tiralin</li> <li>Rune of Dunmore</li> <li>Rune of Dwarf Tower</li> <li>Rune of the Cave World</li> <li>Rune of the Ice World</li> <li>Rune of the Realm of Clouds</li> <li>Rune of the Shadow Realm</li> <li>Rune of the Cottage Rune</li> <li>Forest Rune II</li> <li>Swamp Rune II</li> <li>Mountain Rune II</li> <li>Cave Rune II</li> <li>Sky Rune II</li> <li>Dark Rune II</li> <li>Fairy Corel of Air</li> <li>Fairy Corel of Earth</li> <li>Fairy Corel of Fire</li> <li>Fairy Corel of Nature</li> <li>Fairy Corel of PSI Magic</li> <li>Reserved Magic Card</li> <li>Reserved Magic Card</li> <li>Evolutionary Magic of Air</li> <li>Evolutionary Magic of Fire</li> <li>Evolutionary Magic of Nature</li> <li>Elemental Key of Fire</li> <li>Elemental Key of Air</li> <li>Elemental Key of Nature</li> <li>Elemental Key of Earth</li> <li>Book of Fairies</li> <li>Fairy Bag</li> <li>Mana Potion</li> <li>Molding Magic</li> <li>Map of the Fairy Garden</li> <li>Map of the Enchanted Forest</li> <li>Map of the Mountain World</li> <li>Map of the Dark Swamp</li> <li>Map of the Shadow Realm</li> <li>Map of the Realm Of Clouds</li> <li>Reserved Magic Card</li> <li>Reserved Magic Card</li> <li>Tools of the Dwarfs</li> <li>Red Bone Key</li> <li>Green Bone Key</li> <li>Blue Bone Key</li> </ol>"},{"location":"resources/FBS/fb0x05/","title":"NPCs (fb0x05)","text":"<p>The fifth database contains information about NPCs mostly in the form of scripts.</p>"},{"location":"resources/FBS/fb0x05/#columns","title":"Columns","text":"Idx Name Description 0 Name A foreign key UID to fb0x02 containing the name 1 Script1 This script is executed when the NPC is activated, it often contains dialog control (Impl: 3) 2 Script2 This script seems to be executed when the NPC is deployed, it mostly contains <code>setModel</code> instructions (Impl: 1) 3 Script3 This script seems to be executed on a cyclic basis, but the details are not known yet (Impl: 1) 4 Script4 This script is executed if the player wins a fight against the NPC (Impl: 3) 5 Script5 This script is executed if the player loses a fight against the NPC, mostly contains <code>killPlayer</code> instructions (Impl: 3)"},{"location":"resources/FBS/fb0x06/","title":"Dialogs (fb0x06)","text":"<p>Last but not least the sixth database file which stores all of the dialog text along with a reference to the NPC it belongs and optionally a voice column which is not used at all.</p>"},{"location":"resources/FBS/fb0x06/#columns","title":"Columns","text":"Idx Name Description 0 Text A string containing the dialog text 1 Npc A foreign key UID to fb0x05 to the NPC it belongs to, is not always valid (as there unused lines) 2 Voice This column is always empty and thus can be ignored"},{"location":"resources/RWBS/","title":"Basic information","text":"<p>RWBS stands for RenderWare Binary Stream, this format is used for saving models (.dff) and worlds (.bsp) in ZanZarah. It is comprised by a hierachical structure of sections which either store binary data or other sections, so a common structure is:</p> <ul> <li>Header<ul> <li>RWStruct</li> <li>[some Sections]</li> <li>RWExtension<ul> <li>[some plugin section]</li> <li>[some plugin section]</li> </ul> </li> </ul> </li> </ul> <p>Thanks to the GTA Modding Community the format of many sections are known, some other are also more or less understood and described by kabbi. Unfortunately not all sections used in ZanZarah are decrypted yet.</p>"},{"location":"resources/RWBS/#header-format","title":"Header format","text":"Size Type Description 4b uint section identifier 4b uint section size, including child sections or data 4b uint RenderWare version ID"},{"location":"resources/RWBS/#section-types-used-in-zanzarah","title":"Section types used in ZanZarah","text":""},{"location":"resources/RWBS/#list-sections","title":"List sections","text":"<ul> <li>RWAtomic</li> <li>RWAtomicSection</li> <li>RWClump</li> <li>RWExtension</li> <li>RWFrameList</li> <li>RWGeometry</li> <li>RWGeometryList</li> <li>RWMaterial</li> <li>RWMaterialList</li> <li>RWPlaneSection</li> <li>RWTexture</li> <li>RWWorld</li> </ul>"},{"location":"resources/RWBS/#data-sections","title":"Data sections","text":"<ul> <li>RWStruct</li> <li>RWString</li> <li>RWMorphPLG</li> <li>RWSkinPLG</li> <li>RWBinMeshPLG</li> <li>RWAnimationPLG</li> <li>RWCollisionPLG</li> </ul>"},{"location":"resources/RWBS/RWAnimationPLG/","title":"RWAnimationPLG (0x0108)","text":"<p>The RWAnimationPLG section is the most confusing section of all, not much of it is understood at the moment.</p> <p>It can be seen as child of RWClump, as well as single child of the many RWExtension sections of RWClump-&gt;RWFrameList.</p>"},{"location":"resources/RWBS/RWAnimationPLG/#data-format","title":"Data format","text":"Size Type Description 4b int i1 4b bool optionaldetermines if the next items are stored 4b uint ii1 4b uint count of items1 4b uint count of items2 AnimData[] items1 AnimData[] items2"},{"location":"resources/RWBS/RWAnimationPLG/#animdata","title":"AnimData","text":"Size Type Description zstring name 4b enum Currently only Type1 or Type2Determines type of innerItems1 4b uint count of innerItems1 4b uint count of innerItems2 InnerItems1[] innerItems1 InnerItems2[] innerItems2"},{"location":"resources/RWBS/RWAnimationPLG/#inneritems1","title":"InnerItems1","text":"Size Type Description 4b float f1 4b float f2 4b float f3 4b float f4Only if type is Type2"},{"location":"resources/RWBS/RWAnimationPLG/#inneritems2","title":"InnerItems2","text":"Size Type Description 4b uint i1 4b uint i2 4b float f"},{"location":"resources/RWBS/RWAtomic/","title":"RWAtomic (0x0014)","text":"<p><code>Atomic is a container section used in DFF files as child of a Clump section. It is normally accompanied by a Struct section. An atomic section can associate a Frame with a Geometry.</code> - gtamodding</p>"},{"location":"resources/RWBS/RWAtomic/#structure-format","title":"Structure format","text":"Size Type Description 4b uint frameIndex 4b uint geometryIndex 4b flags Possible flags are CollisionTest(0x01) and Render(0x04) 4b uint unused"},{"location":"resources/RWBS/RWAtomic/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWGeometry</li> <li>RWExtension<ul> <li>RWSkinPLG</li> </ul> </li> </ul>"},{"location":"resources/RWBS/RWAtomicSection/","title":"RWAtomicSection (0x0009)","text":"<p>This section is used to define a piece of the world geometry, it is usually child of a RWPlaneSection and propagated through other RWPlaneSection to a RWWorld section.</p> <p>The format of this section was decrypted by kabbi.</p>"},{"location":"resources/RWBS/RWAtomicSection/#structure-format","title":"Structure format","text":"Size Type Description 4b uint materialIdBase 4b uint triangleCount 4b uint vertexCount 12b Vector bbox1 12b Vector bbox1 4b uint unused1 4b uint unused2 Vector[] vertices Normal[] normals (1 per vector)optional only if world flags contain Normals 4b uint[] colors (1 per vector)optional only if world flags contain Prelit TexCoord[] texCoords1 (1 per vector)optional only if world flags contain Textured or Textured2 TexCoord[] texCoords2 (1 per vector)optional only if world flags contain Textured2 Triangle[] triangles"},{"location":"resources/RWBS/RWAtomicSection/#normal","title":"Normal","text":"Size Type Description 1b uint x 1b uint y 1b uint z 1b int p"},{"location":"resources/RWBS/RWAtomicSection/#texcoord","title":"TexCoord","text":"Size Type Description 4b float u 4b float v"},{"location":"resources/RWBS/RWAtomicSection/#triangle","title":"Triangle","text":"Size Type Description 2b uint m 2b uint v1 2b uint v2 2b uint v3"},{"location":"resources/RWBS/RWAtomicSection/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWExtension<ul> <li>RWBinMeshPLG</li> <li>RWCollisionPLG</li> </ul> </li> </ul>"},{"location":"resources/RWBS/RWBinMeshPLG/","title":"RWBinMeshPLG (0x050E)","text":"<p><code>The Bin Mesh plugin holds an optimized representation of the model topology. Triangles are grouped together into Meshes by their Material and stored as triangle strips when the rpGEOMETRYTRISTRIP flag (0x1) is set in the Geometry, otherwise as triangle lists.</code> -  gtamodding</p> <p>This section can usually be seen as RWExtension childs of RWGeometry or RWAtomicSection. The size of the indices datatype would change to 16 bit if the executable were build for OpenGL. As ZanZarah is DirectX exclusive we ignore this case and always work with 32 bit.</p>"},{"location":"resources/RWBS/RWBinMeshPLG/#structure-format","title":"Structure format","text":"Size Type Description 4b enum TriList (0) or TriStrip (1) 4b uint count of sub-Meshes 4b uint total count of indices Mesh[] the sub-meshes"},{"location":"resources/RWBS/RWBinMeshPLG/#mesh","title":"Mesh","text":"Size Type Description 4b uint count of indices 4b uint material index (of the geometry/world material list) 4b uint[] indices"},{"location":"resources/RWBS/RWClump/","title":"RWClump (0x0010)","text":"<p><code>A Clump is a container for a Frame hierarchy to which Atomics, Lights and Cameras are attached.</code> - gtamodding</p> <p>As ZanZarah does not save any light or camera data this section is exclusively used as root section of DFF files. The structure data is not really intersting as the count of Atomics, etc. can be counted by just reading the other child sections.</p>"},{"location":"resources/RWBS/RWClump/#structure-format","title":"Structure format","text":"Size Type Description 4b uint number of Atomics 4b uint number of Lights optional only after version 0x33000 4b uint number of Cameras optional only after version 0x33000"},{"location":"resources/RWBS/RWClump/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWAtomic</li> <li>RWLight</li> <li>RWCamera</li> <li>RWFrameList</li> <li>RWGeometryList</li> <li>RWExtension<ul> <li>RWCollisionModel</li> </ul> </li> </ul>"},{"location":"resources/RWBS/RWCollisionPLG/","title":"RWCollisionPLG (0x011D)","text":"<p>The RWCollisionPLG section should obviously store collision data and can be found as RWExtension childs of RWAtomicSections.</p> <p>Unfortunately neither the GTA community nor kabbi bothered to decrypt this format, but as it seems the collision data is equiavalent to the rendering geometry.</p> <p>TODO: thanks to a leak, this format should be derivable now</p>"},{"location":"resources/RWBS/RWExtension/","title":"RWExtension (0x0003)","text":"<p>Extension sections are the only list section without a meaningful RWStruct child section attached to it. It is used to store sections by RenderWare plugins and thus can be found in many common list sections.</p>"},{"location":"resources/RWBS/RWExtension/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWAnimationPLG</li> <li>RWBinMeshPLG</li> <li>RWCollisionPLG</li> <li>RWMorphPLG</li> <li>RWSkinPLG</li> </ul>"},{"location":"resources/RWBS/RWFrameList/","title":"RWFrameList (0x000E)","text":"<p>The Frame list stores \"Frames\" whatever these magical structures might be...</p> <p>It can be seen as child of RWAtomic sections.</p>"},{"location":"resources/RWBS/RWFrameList/#structure-format","title":"Structure format","text":"Size Type Description 4b uint count of frames Frame[] frames"},{"location":"resources/RWBS/RWFrameList/#frame","title":"Frame","text":"Size Type Description 36b Mat3x3 rotation matrix 12b Vector position 4b uint parent frame 4b uint matrix creation flags (unused)"},{"location":"resources/RWBS/RWFrameList/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWExtension<ul> <li>RWAnimationPLG</li> </ul> </li> </ul>"},{"location":"resources/RWBS/RWGeometry/","title":"RWGeometry (0x000F)","text":"<p>This section stores geometric data of models.</p> <p>It can be seen as child of RWGeometryList sections.</p>"},{"location":"resources/RWBS/RWGeometry/#structure-format","title":"Structure format","text":"Size Type Description 4b enum format (see below) 4b uint count of triangles 4b uint count of vertices 4b uint count of morph targets (should always be 1) 4b float ambient optional only after 0x33000 4b float specular optional only after 0x33000 4b float diffuse optional only after 0x33000 <p>optional  only if  format does not contain Native :</p> Size Type Description 4b uint[] prelitcolor optional only if format contains Prelit TexCoord[,] texCoords (see below) GTriangle[] triangles MorphTarget[] not optional"},{"location":"resources/RWBS/RWGeometry/#morphtarget","title":"MorphTarget","text":"Size Type Description 12b Vector Center of bounding sphere 4b float Radius of bounding sphere 4b bool hasVertices 4b bool hasNormals Vector[] vertices Vector[] normals (1 per vertex)"},{"location":"resources/RWBS/RWGeometry/#texcoord","title":"TexCoord","text":"Size Type Description 4b float u 4b float v"},{"location":"resources/RWBS/RWGeometry/#gtriangle","title":"GTriangle","text":"Size Type Description 2b uint v2 2b uint v3 2b uint m 2b uint v1"},{"location":"resources/RWBS/RWGeometry/#format-enum","title":"format enum","text":"Name Value Tristrip 0x00000001 Positions 0x00000002 Textured 0x00000004 Prelit 0x00000008 Normals 0x00000010 Light 0x00000020 ModulateMaterialColor 0x00000040 Textured2 0x00000080 Native 0x01000000 <p><code>Bits 16-23 (mask 0x00FF0000) in the format description give the number of texture coordinate sets (numTexSets).</code> - gtamodding If this value is 0, format decides over the number of texture coordinate sets.</p>"},{"location":"resources/RWBS/RWGeometry/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWMaterialList</li> <li>RWExtension<ul> <li>RWBinMeshPLG</li> <li>RWMorphPLG</li> </ul> </li> </ul>"},{"location":"resources/RWBS/RWGeometryList/","title":"RWGeometryList (0x001A)","text":"<p>RWGeometryList is usually the child of a RWClump section and only contains RWGeometry sections besides its own RWStruct, which does not have very interesting data.</p>"},{"location":"resources/RWBS/RWGeometryList/#structure-format","title":"Structure format","text":"Size Type Description 4b uint number of geometries"},{"location":"resources/RWBS/RWGeometryList/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWGeometry</li> </ul>"},{"location":"resources/RWBS/RWMaterial/","title":"RWMaterial (0x0007)","text":"<p>This section stores information about how the geometry should look like.</p> <p>It is usually the child of a RWMaterialList section.</p>"},{"location":"resources/RWBS/RWMaterial/#structure-format","title":"Structure format","text":"Size Type Description 4b uint flags unused 4b uint color 4b uint unused 4b bool isTextured 4b float ambient optional only after 0x30300 4b float specular optional only after 0x30300 4b float diffuse optional only after 0x30300"},{"location":"resources/RWBS/RWMaterial/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWTexture</li> <li>RWExtension</li> </ul>"},{"location":"resources/RWBS/RWMaterialList/","title":"RWMaterialList (0x0008)","text":"<p>The material list section stores one or many RWMaterial sections.</p> <p>It is usually the child of a RWGeometry or RWWorld section.</p>"},{"location":"resources/RWBS/RWMaterialList/#structure-format","title":"Structure format","text":"Size Type Description 4b uint number of materials including material instances 4b uint[] material indices <p><code>A material index equals -1 if it is a material. If the material is an instance of a previously defined material, the index equals the base materials one.</code> - gtamodding</p>"},{"location":"resources/RWBS/RWMaterialList/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWMaterial</li> </ul>"},{"location":"resources/RWBS/RWMorphPLG/","title":"RWMorphPLG (0x0105)","text":"<p>The morph plugin is a small RWExtension child of a RWGeometry section. Its use is not clear.</p>"},{"location":"resources/RWBS/RWMorphPLG/#structure-format","title":"Structure format","text":"Size Type Description 4b uint morph target index"},{"location":"resources/RWBS/RWPlaneSection/","title":"RWPlaneSection (0x000A)","text":"<p>The plane section section presumably stores information about a dividing plane of a world (as ZanZarah uses Binary Space Partition) and thus usually has one or two RWAtomicSection or other plane sections as childs.</p> <p>The format was decrypted by kabbi but some meaning remains hidden for now.</p>"},{"location":"resources/RWBS/RWPlaneSection/#structure-format","title":"Structure format","text":"Size Type Description 4b uint sector type 4b float value 4b bool leftIsWorldSector 4b bool rightIsWorldSector 4b float leftValue 4b float rightValue"},{"location":"resources/RWBS/RWPlaneSection/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWAtomicSection</li> </ul>"},{"location":"resources/RWBS/RWSkinPLG/","title":"RWSkinPLG (0x0116)","text":"<p>The RWSkinPLG section describes the bones of an actor and how these react with the vertices of the model mesh. It is usually found as RWExtension child of a RWAtomic section.</p> <p>Here is a discrepancy between the format described by gtamodding and the one described by kabbi. The differences are not compatible to each other, but the format by kabbi seems to work, so this is what I will using as well, even though it has some strange properties (see bone matrix).</p>"},{"location":"resources/RWBS/RWSkinPLG/#structure-format","title":"Structure format","text":"Size Type Description 4b uint bone count 4b uint vertex count 4x1b uint[] vertexIndices (1 set per vertex) 4x4b float[] vertexWeights (1 set per vertex) Bone[] bones"},{"location":"resources/RWBS/RWSkinPLG/#bone","title":"Bone","text":"Size Type Description 4b uint i1 4b uint idx 4b BoneFlags bone flags 12b Vector right 4b uint unused 12b Vector up 4b uint unused 12b Vector at 4b uint unused 12b Vector pos 4b uint unused"},{"location":"resources/RWBS/RWSkinPLG/#bone-flags","title":"Bone flags","text":"Flag-Bit Description 0 Is childless 1 Has another sibling 3 unknown"},{"location":"resources/RWBS/RWString/","title":"RWString (0x0002)","text":"<p>The string section is used to store a single string, whose size is determined by the section size.</p> <p>In ZanZarah files it is only used in RWTexture sections.</p>"},{"location":"resources/RWBS/RWStruct/","title":"RWStruct (0x0001)","text":"<p>The RWStruct section is used by every list section (except RWExtension) to define binary information for the parent section.</p>"},{"location":"resources/RWBS/RWTexture/","title":"RWTexture (0x0006)","text":"<p><code>A texture section is used to store identifying information about a texture and it's alpha layer.</code> - gtamodding</p> <p>It is usually the child of a RWMaterial section. It has one to two RWString sections which define the color/alpha texture filename.</p>"},{"location":"resources/RWBS/RWTexture/#structure-format","title":"Structure format","text":"Size Type Description 1b enum filterMode (see below) 4bit enum U addressing mode (see below) 4bit enum V addressing mode (see below) 15bit uint unused"},{"location":"resources/RWBS/RWTexture/#filtermode-enum","title":"filterMode enum","text":"Name Value NAFilterMode 0 Nearest 1 Linear 2 MipNearest 3 MipLinear 4 LinearMipNearest 5 LinearMipLinear 6"},{"location":"resources/RWBS/RWTexture/#uv-addressing-mode","title":"U/V addressing mode","text":"Name Value NATextureAddresss 0 Wrap 1 Mirror 2 Clamp 3 Border 4"},{"location":"resources/RWBS/RWTexture/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWString</li> <li>RWExtension</li> </ul>"},{"location":"resources/RWBS/RWWorld/","title":"RWWorld (0x000B)","text":"<p>The RWWorld section stores header information for the world geometry and is the root section of BSP files. The format was described by kabbi.</p>"},{"location":"resources/RWBS/RWWorld/#structure-format","title":"Structure format","text":"Size Type Description 4b bool rootIsWorldSector 12b Vector invWorldOrigin 4b float ambient 4b float specular 4b float diffuse 4b uint total count of triangles 4b uint total count of plane sectors 4b uint total count of world sectors 4b uint colSectorSize 4b enum format (see below)"},{"location":"resources/RWBS/RWWorld/#format-enum","title":"format enum","text":"Name Value Tristrip 0x00000001 Positions 0x00000002 Textured 0x00000004 Prelit 0x00000008 Normals 0x00000010 Light 0x00000020 ModulateMaterialColor 0x00000040 Textured2 0x00000080 Native 0x01000000 NativeInstance 0x02000000 SectorsOverlap 0x40000000"},{"location":"resources/RWBS/RWWorld/#possible-child-sections","title":"Possible child sections","text":"<ul> <li>RWMaterialList</li> <li>RWPlaneSection</li> <li>RWAtomicSection</li> <li>RWExtension</li> </ul>"},{"location":"resources/SCN/","title":"Basic information","text":"<p>The scene format contains all gameplay-specific informations about a world the player might travel. This also includes all duel arenas where the player is controlling a fairy instead of Amy.  This does not include any form of geometry, which would be stored in BSP and DFF files.</p>"},{"location":"resources/SCN/#general-format","title":"General format","text":"<ul> <li>The scene format consists of several sections each of which may only occur once in the file and each of which has its own binary format.</li> <li>Each sections starts with a section name as a zstring and its size is determined by its content.</li> <li>A section name is always contained in brackets <code>[...]</code></li> <li>The first section name to occur is <code>Scenefile</code> which does not have any further content.</li> <li>The last section name is <code>EOS</code> which also does not have any further content.</li> <li>Many sections contain an structure array whose count is the first unsigned 32bit integer in the section content.</li> <li>The following sections may occur:</li> </ul>"},{"location":"resources/SCN/#sections","title":"Sections","text":"Link Name(s) Description  [x]  Version information about build version, date/time, author, release country...  [x]  Misc mostly unknown information about the scene in general  [x]  WaypointSystem mostly unknown information about the waypoints  [x]  Dataset various gameplay information like scene id or name -/- SceneOrigin A vector to the middle of the world  [x]  Backdrop A specifier about the background of the scene  [x]  Lights A collection of light information  [x]  FOModels  FOModels_v2  FOModels_v3  FOModels_v4 A collection of optional models  [x]  Models  Models_v2  Models_v3  Models_v4 A collection of important models  [x]  DynamicModels A collection of apparence-changing models  [x]  Triggers A collection of triggers  [x]  Samples  2DSamples_v2 A collection of 2D samples  [x]  3DSamples_v2 A collection of 3D samples  [x]  Effects  Effects_v2 A collection of effects  [x]  VertexModifiers mostly unknown collection of vertex modifiers  [x]  TextureProperties Footsteps applicable to certain textures  [x]  Behaviors collection of Behaviors tied to models  [x]  Scene completly unknown collection about scene items -/- SoundProvider An unused specifier (32bit uint) about some kind of sound settings  [x]  AmbientSound A specifier about the ambient sounds  [x]  Music A specifier about the music"},{"location":"resources/SCN/SCN_2DSample/","title":"2D Samples (2DSamples_v2)","text":"<p>This sections describes 2D samples, but much is yet to be known how these are triggered.</p>"},{"location":"resources/SCN/SCN_2DSample/#format","title":"Format","text":"<p>The section is an array of 2DSample structures.</p> Size Type Description 4B uint index in FX category (see SceneItemTypes) zstring sound filename 4B uint volume (0-100) 4B uint loop count 1B uint unknown some flag"},{"location":"resources/SCN/SCN_3DSample/","title":"3D Samples (3DSamples_v2)","text":"<p>This sections describes 3D samples, but much is yet to be known how these are triggered.</p>"},{"location":"resources/SCN/SCN_3DSample/#format","title":"Format","text":"<p>The section is an array of 3DSample structures.</p> Size Type Description 4B uint index in FX category (see SceneItemTypes) zstring sound filename 12B Vec3f position 12B Vec3f forward 12B Vec3f up 4B float minimal distance 4B float maximum distance 4B uint volume (0-100) 4B uint loop count 4B uint falloff (probably priority based on distance)"},{"location":"resources/SCN/SCN_AmbientSound/","title":"AmbientSound","text":"<p>This section only holds a single 32Bit unsigned integer between 0 and 16 (inclusive), which describes the hardcoded collection of landscape sounds which are played propably at random.</p> <p>For more information see AmbientSoundMgr.</p>"},{"location":"resources/SCN/SCN_Backdrop/","title":"Backdrop","text":"<p>This section is composed out of a single zstring, which sometimes is a backdrop model which is then used as a static background.  If however this string has a underscore <code>_</code>, there is a number to the left of said underscore which is used by the game to add a hardcoded dynamic background. To the right of the underscore there is a short description of the background which is ignored by the game.</p> Number Used Name Description 1 Yes Vortex 2 Yes Forest 3 Yes Horizon 4 No -/- 5 Yes Swamp 6 No -/- 7 Yes Mountain1 8 No -/- 9 No -/- 10 Yes Garden 11 No -/- 12 Yes waterduel 13 No -/- 14 No -/- 15 Yes DuelSwamp 16 Yes Trainer 17 Yes DuelSpecial 18 Yes DuelLava 19 Yes PreDuel"},{"location":"resources/SCN/SCN_Behavior/","title":"Behaviors","text":"<p>This section describes how the game should process certain models.</p>"},{"location":"resources/SCN/SCN_Behavior/#format","title":"Format","text":"Size Type Description 4B enum Behavior type 4B uint model idx this Behavior should be connected to"},{"location":"resources/SCN/SCN_Behavior/#behaviortype","title":"BehaviorType","text":"<p>The game groups certain Behavior types to one main functionality and then splits up accordingly.</p> Value Name Description 800 Cloud unused 900 SmpleDoorLeft 901 SimpleDoorRight 902 MetalDoorLeft unused 903 CityDoorDown unused 904 CityDoorUp 910 DoorGold see details 911 DoorSilver see details 912 DoorCopper see details 913 DoorBronze see details 914 DoorIron see details 915 DoorPlating unused 916 DoorGlass see details 917 DoorWithLock unused 918 CityDoorLock see details 919 LockedMetalDoor 920 LockedWoodenDoor unused 921 DoorRed see details 922 DoorYellow see details 923 DoorBlue see details 1000 Collectable see details 1001 Collectable_EFF0 1002 Collectable_EFF1 unused 1010 GenCollectable only generated at runtime, not an original name 1011 GenCollectable_EFF0 only generated at runtime (used for coins/crystals), not an original name 1012 GenCollectable_EFF1 only generated at runtime (propably unused), not an original name 1100 Lock 1500 BlockerStone 1501 BlockerPlant unused 1502 MagicBridgeStatic 1503 IronGate unused 1504 MagicBridge0 1505 MagicBridge1 1506 MagicBridge2 2000 LookAtPlayer unused 2001 Swing 2002 FlameAnimation unused 2003 SkyMovement 2004 River2 2005 River3 2006 River4 unused 2007 WaterAnimation unused 2008 YRotate1 2009 YRotate2 2010 Bird unused 2011 TextureWobble unused 2012 SimpleCorona unused 2013 BirdCircle unused 2014 ZRotate1 2015 ZRotate2 2016 XRotate1 2017 XRotate2 2018 River5 unused 2019 River6 unused 2020 River7 unused 2021 River8 unused 2100 FlyAwayVisible unused 2101 FlyAwayInvisible unused 2102 FlyAwayStraight unused"},{"location":"resources/SCN/SCN_Dataset/","title":"Dataset","text":"<p>This section stores various gameplay information about the current scene. Unfortunately the functionality of many flags are not known to this date.</p>"},{"location":"resources/SCN/SCN_Dataset/#format","title":"Format","text":"Size Type Description 4B uint size of inner data, either 32 or 36 4B uint scene id 4B enum scene type 4B uint a string UID containing the name of the scene 1B uint unknown flag 1B uint unknown flag 2B structural padding 4B bool unknown 1B bool can the player change his deck here 3B structural padding 4B uint unknown always 0 4B bool unknown 4B bool if size == 36 unknown zstring always empty zstring always empty"},{"location":"resources/SCN/SCN_Dataset/#scene-type","title":"Scene type","text":"Value Description 0 Overworld scene 1 Arena 2 Multiplayer scene"},{"location":"resources/SCN/SCN_DynamicModel/","title":"DynamicModels","text":"<p>This section describes models which can change their appearence over time, but there is little information how and in which way this occurs.</p>"},{"location":"resources/SCN/SCN_DynamicModel/#format","title":"Format","text":"<p>The section content contains an structural array.</p> Size Type Description 4B uint some kind of index 4B uint unknown some integer 4B uint unknown some integer 12B Vec3f position 12B Vec3f direction vector 4B float unknown floating parameter 4B float unknown floating parameter 12B Vec3f unknown some vector 4B uint unknown some integer 4B uint unknown some integer DynModelData[3] unknown change parameters (see DynModelData)"},{"location":"resources/SCN/SCN_DynamicModel/#dynmodeldata","title":"DynModelData","text":"Size Type Description 4B float unknown some floating parameter 4B float unknown some floating parameter 4B float unknown some floating parameter 4B float unknown some floating parameter 4B float unknown some floating parameter 4B float unknown some floating parameter 4B float unknown some floating parameter 1B uint unknown some integer 4B uint unknown some color 4B uint unknown some integer parameter zstring model filename zstring texture filename"},{"location":"resources/SCN/SCN_Effect/","title":"Effects (Effects[_v2])","text":"<p>These sections describe simple effects or how complex effects (per file) should be included.</p>"},{"location":"resources/SCN/SCN_Effect/#format","title":"Format","text":"<p>Each section is an array of their respective structure.</p>"},{"location":"resources/SCN/SCN_Effect/#effect","title":"Effect","text":"Size Type Description 4B uint some kind of index 4B enum effect type EffectData effect type specific data"},{"location":"resources/SCN/SCN_Effect/#effect_v2","title":"Effect_v2","text":"Size Type Description 4B uint some kind of index 4B enum effect type 4B uint unknown some integer parameter 4B uint unknown some integer parameter 4B uint unknown some integer parameter 4B uint unknown some integer parameter 4B uint unknown some integer parameter EffectData effect type specific data"},{"location":"resources/SCN/SCN_Effect/#effect-type","title":"Effect type","text":"Value Description 1 4 unused 5 unused 6 7 unused 10 11 Snowflakes 13"},{"location":"resources/SCN/SCN_Effect/#effect-data","title":"Effect data","text":"<p>if type == 1 or 5 or 6 or 10</p> Size Type Description 4B uint unknown some integer parameter 12B Vec3f unknown some vector 12B Vec3f unknown some vector <p>if type == 4</p> Size Type Description 4B uint unknown some integer parameter 12B Vec3f unknown some vector <p>if type == 7</p> Size Type Description zstring effect filename 12B Vec3f unknown some vector <p>if type == Snowflakes</p> Size Type Description 4B uint unknown some integer parameter <p>if type == 13</p> Size Type Description zstring effect filename 12B Vec3f unknown some vector 12B Vec3f unknown some vector 12B Vec3f unknown some vector 4B uint unknown some integer parameter"},{"location":"resources/SCN/SCN_FOModel/","title":"FOModels (FOModels[_v?])","text":"<p>These sections describe optional models, which are not essential to the gameplay.  There are different version of the section, but for now only FOModels_v4 is described, as the older versions are not used in the game files.</p>"},{"location":"resources/SCN/SCN_FOModel/#format","title":"Format","text":"<p>Each section is a array of their respective structure.</p>"},{"location":"resources/SCN/SCN_FOModel/#fomodel_v4","title":"FOModel_v4","text":"Size Type Description 4B uint some kind of index zstring model filename 12B Vec3f position 12B Vec3f direction vector 4B Vec3f unknown some floating parameter 4B Vec3f unknown some floating parameter 4B Vec3f unknown some floating parameter 4B Vec3f unknown some floating parameter 4B Vec3f unknown some floating parameter 4B uint color 1B uint detail level at which the model is rendered 1B uint unknown 4B enum render type 1B uint unknown 4B uint unknown"},{"location":"resources/SCN/SCN_FOModel/#render-type","title":"Render type","text":"Value Name Description 0 Standard1 Alpha cutout 1 Additive1 2 EnvMap32 3 EnvMap64 4 EnvMap96 used in the cathedral 5 EnvMap128 6 EnvMap196 used for the house windows in London 7 EnvMap255 used for the cupboard windows in London 8 Standard2 Metallic? 9 Standard3 Plants? 10 Additive2 used for cob webs 11 Additive3"},{"location":"resources/SCN/SCN_Light/","title":"Lights","text":"<p>As the name states, this section defines the scene lights although its effect is yet to be shown.</p>"},{"location":"resources/SCN/SCN_Light/#format","title":"Format","text":"<p>The section is an array of light structures.</p> Size Type Description 4B uint index in light category (see SceneItemTypes) 4B enum Type of the light 4B float Color component red 4B float Color component green 4B float Color component blue 4B float Color component alpha 4B uint Flags (see light-flags) Type-specific data"},{"location":"resources/SCN/SCN_Light/#directional-light","title":"Directional light","text":"Size Type Description 12B Vec3f position 12B Vec3f direction"},{"location":"resources/SCN/SCN_Light/#point-light","title":"Point light","text":"Size Type Description 4B float radius 12B Vec3f position"},{"location":"resources/SCN/SCN_Light/#spot-light","title":"Spot light","text":"<p>The cone angle of spot lights are hard-coded to 0.5 radians.</p> Size Type Description 4B float radius 12B Vec3f position 12B Vec3f A point for the spot light to look at (only direction is used)"},{"location":"resources/SCN/SCN_Light/#light-type","title":"Light type","text":"Value Description 1 Directional 2 Ambient (not supported by the scene file) 128 Point 129 Spot"},{"location":"resources/SCN/SCN_Misc/","title":"Misc","text":"<p>This section stores some core data about the scene and how it is supposed to be rendered. Internally this section is split into three parts.</p>"},{"location":"resources/SCN/SCN_Misc/#format","title":"Format","text":"Size Type Description zstring Name of the world file zstring Path of the world file (always <code>..\\\\Resources\\\\Worlds\\\\</code>) zstring Path to the world textures (always <code>..\\\\Resources\\\\Textures\\\\Worlds\\\\</code>) 4B uint Color of the ambient light (applied only to Atomics) 12B Vec3f unknown 12B Vec3f unknown 4B uint background color (used for clearing) 1B enum Fog type 4B uint if fog!=None fog color 4B float if fog!=None fog distance 4B float unknown 4B float far clip (near clip is constant at 0.1)"},{"location":"resources/SCN/SCN_Model/","title":"Models (Models[_v?])","text":"<p>These sections describe models which are essential to the gameplay or the design of the scene.  There are different version of the section, but for now only Models_v3 is described, as the other versions are not used in the game files.</p>"},{"location":"resources/SCN/SCN_Model/#format","title":"Format","text":"<p>Each section is an array of their respective structure.</p>"},{"location":"resources/SCN/SCN_Model/#model_v3","title":"Model_v3","text":"Size Type Description 4B uint some kind of index zstring model filename 12B Vec3f position 12B Vec3f direction vector 12B Vec3f scale 4B uint color 1B uint unknown 4B uint unknown 1B uint unknown"},{"location":"resources/SCN/SCN_Music/","title":"Music","text":"<p>This section which only holds a single 32Bit unsigned integer describes a hardcoded music to be played in the scene.  Unfortunately most scenes are specifying 0 as their music, so the real mapping has to be found yet.</p> Value Title Author 0 Main menu Karina Gretere 1 Endeva Karina Gretere 2 Tiralin Matthias Steinwachs 3 Dunmore Matthias Steinwachs 4 Monagham Matthias Steinwachs 5 Battle Theme Karina Gretere 6 Player won battle unknown 7 Player is killed unknown"},{"location":"resources/SCN/SCN_Sample/","title":"Samples [unused]","text":"<p>The documentation of this section is delayed as it isn't used anymore in the game files.</p>"},{"location":"resources/SCN/SCN_Scene/","title":"SceneItems (Scene)","text":"<p>This section describes some mapping between items from this scene to names, but most names are empty. How this mapping works is unclear. This most likely is just debug information.</p>"},{"location":"resources/SCN/SCN_Scene/#format","title":"Format","text":"Size Type Description zstring name 4B uint unknown some integer 4B uint unknown some integer"},{"location":"resources/SCN/SCN_TextureProperty/","title":"TextureProperties","text":"<p>This section describes the kind of footstep applicable to this texture.</p>"},{"location":"resources/SCN/SCN_TextureProperty/#format","title":"Format","text":"<p>The section is an array of TextureProperty structures.</p> Size Type Description zstring texture filename 4B enum see FootstepType"},{"location":"resources/SCN/SCN_TextureProperty/#footsteptype","title":"FootstepType","text":"<p>Every footstep has four different sound files to play (all in the directory AUDIO/SFX/FOOTSTEPS, except for _s013 which can be found in AUDIO/SFX/SPECIALS)</p> Value Description File1 File2 File3 File4 0 Wood/Stone? _f004 _f005 _f006 _f007 1 Snow _f016 _f017 _f018 _f019 2 Metal _f012 _f013 _f014 _f015 3 Wood _f008 _f009 _f010 _f011 4 Grass _f000 _f001 _f002 _f003 5 Mud _f020 _f021 _f022 _f023 6 Marmor _f024 _f025 _f026 _f027 7 Outdoor roads/pathways _f028 _f029 _f030 _f031 8 Stone in the mountains _f032 _f033 _f034 _f035 9 Snow (edge to stone) _f036 _f037 _f038 _f039 10 Metal (lightly damped) _f040 _f041 _f042 _f043 11 Wood, footbridges _f044 _f045 _f046 _f047 12 Grass unused _f048 _f049 _f050 _f051 13 Mud unused _f052 _f053 _f054 _f055 14 Damped wood or carpet _f056 _f057 _f058 _f059 15 Swamp soil _f060 _f061 _f062 _f063 16 Creaky wood (stairs?) _f064 _f065 _f066 _f067 17 Carpet _f068 _f069 _f070 _f071 18 Hard soil _f076 _f077 _f078 _f079 19 Wood unused _f072 _f073 _f074 _f075 N/A Water _s013 _s013 _s013 _s013 <p>Unused in this list are _f080, _f081, _f082 and _f083 which are loud splash noises from when Amy jumps into water.</p>"},{"location":"resources/SCN/SCN_Trigger/","title":"Triggers","text":"<p>This section describes areas in the scene and how the game shall use them.</p>"},{"location":"resources/SCN/SCN_Trigger/#format","title":"Format","text":"<p>The section is an array of Trigger structures.</p> Size Type Description 4B uint some kind of index 4B enum collider type 4B uint flag if direction should be normalized 12B Vec3f direction 4B enum trigger type 4B uint trigger type specific parameter 4B uint trigger type specific parameter 4B uint trigger type specific parameter 4B uint trigger type specific parameter zstring Mostly empty and unused string 12B Vec3f position 12B Vec3f collider type == Box size 4B float collider type == Sphere radius"},{"location":"resources/SCN/SCN_Trigger/#collider-type","title":"Collider Type","text":"Value Description 0 Box 1 Sphere 2 Point <p>Note that internally, there are more collider types, but these are the ones used in the game.</p>"},{"location":"resources/SCN/SCN_Trigger/#trigger-type","title":"Trigger Type","text":"Value Name Description 0 Doorway used as entrance/exit of a scene, see detail page 1 SingleplayerStartpoint see detail page 2 MultiplayerStartpoint 3 NpcStartpoint 4 CameraPosition used by scripts to change the camera view, see detail page 5 Waypoint used for NPCs, see detail page 6 StartDuel used only internally 7 LeaveDuel used only internally 8 NpcAttackPosition used mostly for wild fairies, see detail page 9 FlyArea used only internally 10 KillPlayer 11 SetCameraView used only internally 12 SavePoint used only internally 13 SwampMarker 14 RiverMarker 15 PlayVideo used only internally 16 Elevator in the executable it is actually called teleporter 17 GettingACard used only internally 18 Sign 19 GettingPixie used only internally 20 UsingPipe used only internally 21 DancePlatform used only internally 22 LeaveDancePlatform used only internally 23 RemoveStoneBlocker used only internally 24 RemovePlantBlocker used only internally 25 EventCamera this trigger is used by the exectuable to set the camera on certain events like removing stone/plant blockers, CreatePlatforms, etc. 26 Platform see detail page 27 CreatePlatforms see detail page 28 ShadowLight 29 CreateItems see detail page 30 Item see detail page 31 Shrink used only internally 32 WizformMarker used only internally -/- RemoveLock this name is in the executable, but it messes up with the rest of the types 33 IndoorCamera used only internally 34 LensFlare used only internally 35 FogModifier 36 OpenMagicWaypoints used only internally 37 RuneTarget not an original name, used to place Amy after teleporting with rune, ii1 either 0 or 1000, meaning unknown 38 Unused38 no name present in the executable 39 Animal see detail page 40 AnimalWaypoint see detail page 41 SceneOpening used only internally 42 CollectionWizform used in London to place the unused fairies 43 ElementalLock 44 ItemGenerator 45 Escape 46 Jumper used to place air jump fields, effect number yet to be known 47 RefreshMana used only internally 48 StartSubgame used only internally 49 TemporaryNpc 50 EffectBeam 51 MultiplayerObserverPosition 52 MultiplayerHealingPool 53 MultiplayerManaPool 54 Ceiling used in arena scenes to limit flying height 55 HealAllWizforms"},{"location":"resources/SCN/SCN_VertexModifier/","title":"VertexModifiers","text":"<p>This section describes some kind of vertex modification, but it isn't used in the game files.</p>"},{"location":"resources/SCN/SCN_VertexModifier/#format","title":"Format","text":"<p>The section is an array of VertexModifier structures.</p> Size Type Description 4B uint some kind of index 4B uint unknown some kind of type 12B Vec3f unknown some vector 4B uint unknown some color 12B Vec3f type == 1 unknown some vector 4B uint unknown some integer parameter 1B uint unknown some byte"},{"location":"resources/SCN/SCN_WaypointSystem/","title":"WaypointSystem","text":"<p>This section describes the waypoint system especially for duel scenes, if this section is used for overworld scenes is not confirmed yet. This seems unlikely as none of the arrays for overworld scenes have any content. The waypoints for these scenes are set with triggers. Although the executable does not read certain data for different versions, the only versions used in the files are 5 and 6.</p>"},{"location":"resources/SCN/SCN_WaypointSystem/#format","title":"Format","text":"Size Type Description 4B uint Version of the waypoint system format 4B uint This field has to be zero 24B byte[] version &gt;= 5 unknown 4B uint count of waypoints Waypoint[] see waypoint format 4B uint version &gt;= 2 count of unknown secondary data SecondaryData[] version &gt;= 2 see secondary data format WaypointExt[] version &gt;= 3 for each waypoint some additional information, see waypoint extension format 4B uint This field has to be 0xFFFF"},{"location":"resources/SCN/SCN_WaypointSystem/#waypoint","title":"Waypoint","text":"Size Type Description 4B uint probably an id, unique for every waypoint per scene 4B uint version &gt;= 4 probably an id to another element (is never bigger than the count of waypoints) 12B Vec3f position 4B uint count of first inner data uint[] first inner data, array of waypoint ids 4B uint count of second inner data uint[] second inner data, array of waypoint ids"},{"location":"resources/SCN/SCN_WaypointSystem/#waypoint-extension","title":"Waypoint extension","text":"Size Type Description 4B uint count of third inner data uint[] third inner data, array of waypoint ids"},{"location":"resources/SCN/SCN_WaypointSystem/#secondary-data","title":"Secondary data","text":"Size Type Description 4B uint probably an id, does not reference a waypoint 4B uint count of inner data uint[] inner data, array of secondary data ids"},{"location":"resources/SCN/SCN_WaypointSystem/#more-understandable-format","title":"More understandable format","text":"<p>As this format is rather complex, it is probably helpful for a different explanation:</p> <ul> <li>The waypoint system has two arrays of data: waypoints and unknown secondary data<ul> <li>Waypoints are composed out of<ul> <li>An id unequal to their index in the array</li> <li>Another id not always but sometimes the same as the first one</li> <li>A position vector</li> <li>Three arrays with waypoint ids inside them, probably edges between waypoints?</li> </ul> </li> <li>The unknown secondary data is composed out of<ul> <li>An id</li> <li>An array of secondary data ids</li> </ul> </li> </ul> </li> </ul>"}]}